<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="deepfold.utils.geometry package" href="deepfold.utils.geometry.html" /><link rel="prev" title="deepfold.train package" href="deepfold.train.html" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
        <title>deepfold.utils package - IITP PPI 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">IITP PPI 0.0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">IITP PPI 0.0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Welcome to deepfold’s documentation!</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Welcome to deepfold’s documentation!</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="deepfold.html">deepfold package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of deepfold package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="deepfold.common.html">deepfold.common package</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="deepfold.data.html">deepfold.data package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of deepfold.data package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="deepfold.data.modules.html">deepfold.data.modules package</a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.data.multimer.html">deepfold.data.multimer package</a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.data.search.html">deepfold.data.search package</a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.data.tools.html">deepfold.data.tools package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.distributed.html">deepfold.distributed package</a></li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.eval.html">deepfold.eval package</a></li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.losses.html">deepfold.losses package</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="deepfold.modules.html">deepfold.modules package</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of deepfold.modules package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="deepfold.modules.tweaks.html">deepfold.modules.tweaks package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.ops.html">deepfold.ops package</a></li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.relax.html">deepfold.relax package</a></li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.runner.html">deepfold.runner package</a></li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.testing.html">deepfold.testing package</a></li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.train.html">deepfold.train package</a></li>
<li class="toctree-l3 current has-children current-page"><a class="current reference internal" href="#">deepfold.utils package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of deepfold.utils package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html">deepfold.utils.geometry package</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/deepfold/deepfold.utils.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="deepfold-utils-package">
<h1>deepfold.utils package<a class="headerlink" href="#deepfold-utils-package" title="Link to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="deepfold.utils.geometry.html">deepfold.utils.geometry package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="deepfold.utils.geometry.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="deepfold.utils.geometry.html#module-deepfold.utils.geometry.quat_rigid">deepfold.utils.geometry.quat_rigid module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.quat_rigid.QuatRigid"><code class="docutils literal notranslate"><span class="pre">QuatRigid</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.quat_rigid.QuatRigid.forward"><code class="docutils literal notranslate"><span class="pre">QuatRigid.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deepfold.utils.geometry.html#module-deepfold.utils.geometry.rigid_matrix_vector">deepfold.utils.geometry.rigid_matrix_vector module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><code class="docutils literal notranslate"><span class="pre">Rigid3Array</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.apply"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.apply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.apply_inverse_to_point"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.apply_inverse_to_point()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.apply_to_point"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.apply_to_point()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.cat"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.cat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.compose"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.compose()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.compose_rotation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.compose_rotation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.cuda"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.cuda()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.device"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.dtype"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.from_array"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.from_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.from_array4x4"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.from_array4x4()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.from_tensor_4x4"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.from_tensor_4x4()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.identity"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.identity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.inverse"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.inverse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.invert_apply"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.invert_apply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.map_tensor_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.reshape"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.reshape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.rotation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.rotation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.scale_translation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.scale_translation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.shape"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.stop_rot_gradient"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.stop_rot_gradient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.to_tensor"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.to_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.to_tensor_4x4"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.to_tensor_4x4()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.translation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.translation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.unsqueeze()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deepfold.utils.geometry.html#module-deepfold.utils.geometry.rotation_matrix">deepfold.utils.geometry.rotation_matrix module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array"><code class="docutils literal notranslate"><span class="pre">Rot3Array</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.apply_inverse_to_point"><code class="docutils literal notranslate"><span class="pre">Rot3Array.apply_inverse_to_point()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.apply_to_point"><code class="docutils literal notranslate"><span class="pre">Rot3Array.apply_to_point()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.cat"><code class="docutils literal notranslate"><span class="pre">Rot3Array.cat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.from_array"><code class="docutils literal notranslate"><span class="pre">Rot3Array.from_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.from_quaternion"><code class="docutils literal notranslate"><span class="pre">Rot3Array.from_quaternion()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.from_two_vectors"><code class="docutils literal notranslate"><span class="pre">Rot3Array.from_two_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.identity"><code class="docutils literal notranslate"><span class="pre">Rot3Array.identity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.inverse"><code class="docutils literal notranslate"><span class="pre">Rot3Array.inverse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Rot3Array.map_tensor_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.reshape"><code class="docutils literal notranslate"><span class="pre">Rot3Array.reshape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.stop_gradient"><code class="docutils literal notranslate"><span class="pre">Rot3Array.stop_gradient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.to_tensor"><code class="docutils literal notranslate"><span class="pre">Rot3Array.to_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Rot3Array.unsqueeze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.xx"><code class="docutils literal notranslate"><span class="pre">Rot3Array.xx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.xy"><code class="docutils literal notranslate"><span class="pre">Rot3Array.xy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.xz"><code class="docutils literal notranslate"><span class="pre">Rot3Array.xz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.yx"><code class="docutils literal notranslate"><span class="pre">Rot3Array.yx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.yy"><code class="docutils literal notranslate"><span class="pre">Rot3Array.yy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.yz"><code class="docutils literal notranslate"><span class="pre">Rot3Array.yz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.zx"><code class="docutils literal notranslate"><span class="pre">Rot3Array.zx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.zy"><code class="docutils literal notranslate"><span class="pre">Rot3Array.zy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.rotation_matrix.Rot3Array.zz"><code class="docutils literal notranslate"><span class="pre">Rot3Array.zz</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deepfold.utils.geometry.html#module-deepfold.utils.geometry.utils">deepfold.utils.geometry.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.utils.get_field_names"><code class="docutils literal notranslate"><span class="pre">get_field_names()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deepfold.utils.geometry.html#module-deepfold.utils.geometry.vector">deepfold.utils.geometry.vector module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array"><code class="docutils literal notranslate"><span class="pre">Vec3Array</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.cat"><code class="docutils literal notranslate"><span class="pre">Vec3Array.cat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.clone"><code class="docutils literal notranslate"><span class="pre">Vec3Array.clone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.cross"><code class="docutils literal notranslate"><span class="pre">Vec3Array.cross()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.dot"><code class="docutils literal notranslate"><span class="pre">Vec3Array.dot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.from_array"><code class="docutils literal notranslate"><span class="pre">Vec3Array.from_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Vec3Array.map_tensor_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.norm"><code class="docutils literal notranslate"><span class="pre">Vec3Array.norm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.norm2"><code class="docutils literal notranslate"><span class="pre">Vec3Array.norm2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.normalized"><code class="docutils literal notranslate"><span class="pre">Vec3Array.normalized()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.reshape"><code class="docutils literal notranslate"><span class="pre">Vec3Array.reshape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.shape"><code class="docutils literal notranslate"><span class="pre">Vec3Array.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.sum"><code class="docutils literal notranslate"><span class="pre">Vec3Array.sum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.to_tensor"><code class="docutils literal notranslate"><span class="pre">Vec3Array.to_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Vec3Array.unsqueeze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.x"><code class="docutils literal notranslate"><span class="pre">Vec3Array.x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.y"><code class="docutils literal notranslate"><span class="pre">Vec3Array.y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.z"><code class="docutils literal notranslate"><span class="pre">Vec3Array.z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.Vec3Array.zeros"><code class="docutils literal notranslate"><span class="pre">Vec3Array.zeros()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.cross"><code class="docutils literal notranslate"><span class="pre">cross()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.dihedral_angle"><code class="docutils literal notranslate"><span class="pre">dihedral_angle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.dot"><code class="docutils literal notranslate"><span class="pre">dot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.euclidean_distance"><code class="docutils literal notranslate"><span class="pre">euclidean_distance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.norm"><code class="docutils literal notranslate"><span class="pre">norm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.normalized"><code class="docutils literal notranslate"><span class="pre">normalized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.vector.square_euclidean_distance"><code class="docutils literal notranslate"><span class="pre">square_euclidean_distance()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deepfold.utils.geometry.html#module-deepfold.utils.geometry">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid"><code class="docutils literal notranslate"><span class="pre">Rigid</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.apply"><code class="docutils literal notranslate"><span class="pre">Rigid.apply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.apply_rot_fn"><code class="docutils literal notranslate"><span class="pre">Rigid.apply_rot_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.apply_trans_fn"><code class="docutils literal notranslate"><span class="pre">Rigid.apply_trans_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.cat"><code class="docutils literal notranslate"><span class="pre">Rigid.cat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.compose"><code class="docutils literal notranslate"><span class="pre">Rigid.compose()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.compose_q_update_vec"><code class="docutils literal notranslate"><span class="pre">Rigid.compose_q_update_vec()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.cuda"><code class="docutils literal notranslate"><span class="pre">Rigid.cuda()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.device"><code class="docutils literal notranslate"><span class="pre">Rigid.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.dtype"><code class="docutils literal notranslate"><span class="pre">Rigid.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.from_3_points"><code class="docutils literal notranslate"><span class="pre">Rigid.from_3_points()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.from_tensor_4x4"><code class="docutils literal notranslate"><span class="pre">Rigid.from_tensor_4x4()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.from_tensor_7"><code class="docutils literal notranslate"><span class="pre">Rigid.from_tensor_7()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.get_rots"><code class="docutils literal notranslate"><span class="pre">Rigid.get_rots()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.get_trans"><code class="docutils literal notranslate"><span class="pre">Rigid.get_trans()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.identity"><code class="docutils literal notranslate"><span class="pre">Rigid.identity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.invert"><code class="docutils literal notranslate"><span class="pre">Rigid.invert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.invert_apply"><code class="docutils literal notranslate"><span class="pre">Rigid.invert_apply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.make_transform_from_reference"><code class="docutils literal notranslate"><span class="pre">Rigid.make_transform_from_reference()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Rigid.map_tensor_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.scale_translation"><code class="docutils literal notranslate"><span class="pre">Rigid.scale_translation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.shape"><code class="docutils literal notranslate"><span class="pre">Rigid.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.stop_rot_gradient"><code class="docutils literal notranslate"><span class="pre">Rigid.stop_rot_gradient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.to_tensor_4x4"><code class="docutils literal notranslate"><span class="pre">Rigid.to_tensor_4x4()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.to_tensor_7"><code class="docutils literal notranslate"><span class="pre">Rigid.to_tensor_7()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Rigid.unsqueeze()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array"><code class="docutils literal notranslate"><span class="pre">Rigid3Array</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.apply"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.apply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.apply_inverse_to_point"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.apply_inverse_to_point()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.apply_to_point"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.apply_to_point()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.cat"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.cat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.compose"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.compose()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.compose_rotation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.compose_rotation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.cuda"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.cuda()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.device"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.dtype"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.from_array"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.from_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.from_array4x4"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.from_array4x4()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.from_tensor_4x4"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.from_tensor_4x4()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.identity"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.identity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.inverse"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.inverse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.invert_apply"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.invert_apply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.map_tensor_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.reshape"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.reshape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.rotation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.rotation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.scale_translation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.scale_translation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.shape"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.stop_rot_gradient"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.stop_rot_gradient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.to_tensor"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.to_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.to_tensor_4x4"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.to_tensor_4x4()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.translation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.translation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rigid3Array.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.unsqueeze()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array"><code class="docutils literal notranslate"><span class="pre">Rot3Array</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.apply_inverse_to_point"><code class="docutils literal notranslate"><span class="pre">Rot3Array.apply_inverse_to_point()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.apply_to_point"><code class="docutils literal notranslate"><span class="pre">Rot3Array.apply_to_point()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.cat"><code class="docutils literal notranslate"><span class="pre">Rot3Array.cat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.from_array"><code class="docutils literal notranslate"><span class="pre">Rot3Array.from_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.from_quaternion"><code class="docutils literal notranslate"><span class="pre">Rot3Array.from_quaternion()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.from_two_vectors"><code class="docutils literal notranslate"><span class="pre">Rot3Array.from_two_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.identity"><code class="docutils literal notranslate"><span class="pre">Rot3Array.identity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.inverse"><code class="docutils literal notranslate"><span class="pre">Rot3Array.inverse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Rot3Array.map_tensor_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.reshape"><code class="docutils literal notranslate"><span class="pre">Rot3Array.reshape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.stop_gradient"><code class="docutils literal notranslate"><span class="pre">Rot3Array.stop_gradient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.to_tensor"><code class="docutils literal notranslate"><span class="pre">Rot3Array.to_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Rot3Array.unsqueeze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.xx"><code class="docutils literal notranslate"><span class="pre">Rot3Array.xx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.xy"><code class="docutils literal notranslate"><span class="pre">Rot3Array.xy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.xz"><code class="docutils literal notranslate"><span class="pre">Rot3Array.xz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.yx"><code class="docutils literal notranslate"><span class="pre">Rot3Array.yx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.yy"><code class="docutils literal notranslate"><span class="pre">Rot3Array.yy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.yz"><code class="docutils literal notranslate"><span class="pre">Rot3Array.yz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.zx"><code class="docutils literal notranslate"><span class="pre">Rot3Array.zx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.zy"><code class="docutils literal notranslate"><span class="pre">Rot3Array.zy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rot3Array.zz"><code class="docutils literal notranslate"><span class="pre">Rot3Array.zz</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation"><code class="docutils literal notranslate"><span class="pre">Rotation</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.apply"><code class="docutils literal notranslate"><span class="pre">Rotation.apply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.cat"><code class="docutils literal notranslate"><span class="pre">Rotation.cat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.compose_q"><code class="docutils literal notranslate"><span class="pre">Rotation.compose_q()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.compose_q_update_vec"><code class="docutils literal notranslate"><span class="pre">Rotation.compose_q_update_vec()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.compose_r"><code class="docutils literal notranslate"><span class="pre">Rotation.compose_r()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.cuda"><code class="docutils literal notranslate"><span class="pre">Rotation.cuda()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.detach"><code class="docutils literal notranslate"><span class="pre">Rotation.detach()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.device"><code class="docutils literal notranslate"><span class="pre">Rotation.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.dtype"><code class="docutils literal notranslate"><span class="pre">Rotation.dtype</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.get_cur_rot"><code class="docutils literal notranslate"><span class="pre">Rotation.get_cur_rot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.get_quats"><code class="docutils literal notranslate"><span class="pre">Rotation.get_quats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.get_rot_mats"><code class="docutils literal notranslate"><span class="pre">Rotation.get_rot_mats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.identity"><code class="docutils literal notranslate"><span class="pre">Rotation.identity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.invert"><code class="docutils literal notranslate"><span class="pre">Rotation.invert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.invert_apply"><code class="docutils literal notranslate"><span class="pre">Rotation.invert_apply()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Rotation.map_tensor_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.requires_grad"><code class="docutils literal notranslate"><span class="pre">Rotation.requires_grad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.shape"><code class="docutils literal notranslate"><span class="pre">Rotation.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.to"><code class="docutils literal notranslate"><span class="pre">Rotation.to()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Rotation.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Rotation.unsqueeze()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array"><code class="docutils literal notranslate"><span class="pre">Vec3Array</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.cat"><code class="docutils literal notranslate"><span class="pre">Vec3Array.cat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.clone"><code class="docutils literal notranslate"><span class="pre">Vec3Array.clone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.cross"><code class="docutils literal notranslate"><span class="pre">Vec3Array.cross()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.dot"><code class="docutils literal notranslate"><span class="pre">Vec3Array.dot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.from_array"><code class="docutils literal notranslate"><span class="pre">Vec3Array.from_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Vec3Array.map_tensor_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.norm"><code class="docutils literal notranslate"><span class="pre">Vec3Array.norm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.norm2"><code class="docutils literal notranslate"><span class="pre">Vec3Array.norm2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.normalized"><code class="docutils literal notranslate"><span class="pre">Vec3Array.normalized()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.reshape"><code class="docutils literal notranslate"><span class="pre">Vec3Array.reshape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.shape"><code class="docutils literal notranslate"><span class="pre">Vec3Array.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.sum"><code class="docutils literal notranslate"><span class="pre">Vec3Array.sum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.to_tensor"><code class="docutils literal notranslate"><span class="pre">Vec3Array.to_tensor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Vec3Array.unsqueeze()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.x"><code class="docutils literal notranslate"><span class="pre">Vec3Array.x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.y"><code class="docutils literal notranslate"><span class="pre">Vec3Array.y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.z"><code class="docutils literal notranslate"><span class="pre">Vec3Array.z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.Vec3Array.zeros"><code class="docutils literal notranslate"><span class="pre">Vec3Array.zeros()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.dihedral_angle"><code class="docutils literal notranslate"><span class="pre">dihedral_angle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.euclidean_distance"><code class="docutils literal notranslate"><span class="pre">euclidean_distance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="deepfold.utils.geometry.html#deepfold.utils.geometry.square_euclidean_distance"><code class="docutils literal notranslate"><span class="pre">square_euclidean_distance()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-deepfold.utils.checkpoint_utils">
<span id="deepfold-utils-checkpoint-utils-module"></span><h2>deepfold.utils.checkpoint_utils module<a class="headerlink" href="#module-deepfold.utils.checkpoint_utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.checkpoint_utils.map_init_state_dicts">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.checkpoint_utils.</span></span><span class="sig-name descname"><span class="pre">map_init_state_dicts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alphafold_state_dict_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_alphafold_state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_optimizer_state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deepfold.utils.checkpoint_utils.map_init_state_dicts" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.checkpoint_utils.resume_checkpoint">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.checkpoint_utils.</span></span><span class="sig-name descname"><span class="pre">resume_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alphafold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deepfold.modules.html#deepfold.modules.alphafold.AlphaFold" title="deepfold.modules.alphafold.AlphaFold"><span class="pre">AlphaFold</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swa_alphafold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.swa_utils.AlphaFoldSWA" title="deepfold.utils.swa_utils.AlphaFoldSWA"><span class="pre">AlphaFoldSWA</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_dirpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#deepfold.utils.checkpoint_utils.resume_checkpoint" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.checkpoint_utils.resume_from_latest_checkpoint">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.checkpoint_utils.</span></span><span class="sig-name descname"><span class="pre">resume_from_latest_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alphafold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deepfold.modules.html#deepfold.modules.alphafold.AlphaFold" title="deepfold.modules.alphafold.AlphaFold"><span class="pre">AlphaFold</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swa_alphafold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.swa_utils.AlphaFoldSWA" title="deepfold.utils.swa_utils.AlphaFoldSWA"><span class="pre">AlphaFoldSWA</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoints_dirpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#deepfold.utils.checkpoint_utils.resume_from_latest_checkpoint" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.checkpoint_utils.save_checkpoint">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.checkpoint_utils.</span></span><span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alphafold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deepfold.modules.html#deepfold.modules.alphafold.AlphaFold" title="deepfold.modules.alphafold.AlphaFold"><span class="pre">AlphaFold</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swa_alphafold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.swa_utils.AlphaFoldSWA" title="deepfold.utils.swa_utils.AlphaFoldSWA"><span class="pre">AlphaFoldSWA</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_dirpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#deepfold.utils.checkpoint_utils.save_checkpoint" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.checkpoint_utils.save_last_checkpoint">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.checkpoint_utils.</span></span><span class="sig-name descname"><span class="pre">save_last_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alphafold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deepfold.modules.html#deepfold.modules.alphafold.AlphaFold" title="deepfold.modules.alphafold.AlphaFold"><span class="pre">AlphaFold</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swa_alphafold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.swa_utils.AlphaFoldSWA" title="deepfold.utils.swa_utils.AlphaFoldSWA"><span class="pre">AlphaFoldSWA</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoints_dirpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_last_checkpoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#deepfold.utils.checkpoint_utils.save_last_checkpoint" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.checkpoint_utils.save_val_checkpoint">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.checkpoint_utils.</span></span><span class="sig-name descname"><span class="pre">save_val_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alphafold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deepfold.modules.html#deepfold.modules.alphafold.AlphaFold" title="deepfold.modules.alphafold.AlphaFold"><span class="pre">AlphaFold</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#deepfold.utils.swa_utils.AlphaFoldSWA" title="deepfold.utils.swa_utils.AlphaFoldSWA"><span class="pre">AlphaFoldSWA</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoints_dirpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_val_checkpoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_avg_lddt_ca</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#deepfold.utils.checkpoint_utils.save_val_checkpoint" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-deepfold.utils.chunk_utils">
<span id="deepfold-utils-chunk-utils-module"></span><h2>deepfold.utils.chunk_utils module<a class="headerlink" href="#module-deepfold.utils.chunk_utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.chunk_utils.chunk_layer">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.chunk_utils.</span></span><span class="sig-name descname"><span class="pre">chunk_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_batch_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_mem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_add_into_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#deepfold.utils.chunk_utils.chunk_layer" title="Link to this definition">¶</a></dt>
<dd><p>Implements the “chunking” procedure described in section 1.11.8.</p>
<p>Layer outputs and inputs are assumed to be simple “pytrees,”
consisting only of (arbitrarily nested) lists, tuples, and dicts with
torch.Tensor leaves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layer</strong> – The layer to be applied chunk-wise</p></li>
<li><p><strong>inputs</strong> – A (non-nested) dictionary of keyworded inputs. All leaves must
be tensors and must share the same batch dimensions.</p></li>
<li><p><strong>chunk_size</strong> – The number of sub-batches per chunk. If multiple batch
dimensions are specified, a “sub-batch” is defined as a single
indexing of all batch dimensions simultaneously (s.t. the
number of sub-batches is the product of the batch dimensions).</p></li>
<li><p><strong>no_batch_dims</strong> – How many of the initial dimensions of each input tensor can
be considered batch dimensions.</p></li>
<li><p><strong>low_mem</strong> – Avoids flattening potentially large input tensors. Unnecessary
in most cases, and is ever so slightly slower than the default
setting.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reassembled output of the layer on the inputs.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-deepfold.utils.crop_utils">
<span id="deepfold-utils-crop-utils-module"></span><h2>deepfold.utils.crop_utils module<a class="headerlink" href="#module-deepfold.utils.crop_utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.crop_utils.unpad_to_schema_shape_">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.crop_utils.</span></span><span class="sig-name descname"><span class="pre">unpad_to_schema_shape_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_schema_shapes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_residues</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_clustered_msa_seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deepfold.utils.crop_utils.unpad_to_schema_shape_" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-deepfold.utils.datetime_utils">
<span id="deepfold-utils-datetime-utils-module"></span><h2>deepfold.utils.datetime_utils module<a class="headerlink" href="#module-deepfold.utils.datetime_utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.datetime_utils.datetime_from_string">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.datetime_utils.</span></span><span class="sig-name descname"><span class="pre">datetime_from_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datetime_string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datetime_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'%Y-%m-%d</span> <span class="pre">%H:%M:%S'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">datetime</span></span></span><a class="headerlink" href="#deepfold.utils.datetime_utils.datetime_from_string" title="Link to this definition">¶</a></dt>
<dd><p>Converts string to datetime object.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.datetime_utils.datetime_to_string">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.datetime_utils.</span></span><span class="sig-name descname"><span class="pre">datetime_to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datetime_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">datetime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'%Y-%m-%d</span> <span class="pre">%H:%M:%S'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#deepfold.utils.datetime_utils.datetime_to_string" title="Link to this definition">¶</a></dt>
<dd><p>Converts datetime object to string.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.datetime_utils.get_timestamp_string">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.datetime_utils.</span></span><span class="sig-name descname"><span class="pre">get_timestamp_string</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#deepfold.utils.datetime_utils.get_timestamp_string" title="Link to this definition">¶</a></dt>
<dd><p>Returns timestamp in <cite>YYYYmmdd_HHMMSS_ffffff</cite> format.</p>
</dd></dl>

</section>
<section id="module-deepfold.utils.dist_utils">
<span id="deepfold-utils-dist-utils-module"></span><h2>deepfold.utils.dist_utils module<a class="headerlink" href="#module-deepfold.utils.dist_utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.dist_utils.get_pad_size">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.dist_utils.</span></span><span class="sig-name descname"><span class="pre">get_pad_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_chunks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#deepfold.utils.dist_utils.get_pad_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.dist_utils.pad_tensor">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.dist_utils.</span></span><span class="sig-name descname"><span class="pre">pad_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.dist_utils.pad_tensor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-deepfold.utils.feats_utils">
<span id="deepfold-utils-feats-utils-module"></span><h2>deepfold.utils.feats_utils module<a class="headerlink" href="#module-deepfold.utils.feats_utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.feats_utils.crop_a3m_string">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.feats_utils.</span></span><span class="sig-name descname"><span class="pre">crop_a3m_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a3m_string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#deepfold.utils.feats_utils.crop_a3m_string" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.feats_utils.crop_features">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.feats_utils.</span></span><span class="sig-name descname"><span class="pre">crop_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.feats_utils.crop_features" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>[</strong><strong>start</strong> (<em>start - 1</em><em>, </em><em>end</em>)</p></li>
<li><p><strong>range</strong> (<em>end</em><em>] </em><em>-&gt;</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-deepfold.utils.file_utils">
<span id="deepfold-utils-file-utils-module"></span><h2>deepfold.utils.file_utils module<a class="headerlink" href="#module-deepfold.utils.file_utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.file_utils.dump_pickle">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.file_utils.</span></span><span class="sig-name descname"><span class="pre">dump_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#deepfold.utils.file_utils.dump_pickle" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.file_utils.find_paths">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.file_utils.</span></span><span class="sig-name descname"><span class="pre">find_paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">PathLike</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deepfold.utils.file_utils.find_paths" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.file_utils.load_pickle">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.file_utils.</span></span><span class="sig-name descname"><span class="pre">load_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#deepfold.utils.file_utils.load_pickle" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.file_utils.read_text">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.file_utils.</span></span><span class="sig-name descname"><span class="pre">read_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#deepfold.utils.file_utils.read_text" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-deepfold.utils.hash_utils">
<span id="deepfold-utils-hash-utils-module"></span><h2>deepfold.utils.hash_utils module<a class="headerlink" href="#module-deepfold.utils.hash_utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.hash_utils.hash_string_into_number">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.hash_utils.</span></span><span class="sig-name descname"><span class="pre">hash_string_into_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#deepfold.utils.hash_utils.hash_string_into_number" title="Link to this definition">¶</a></dt>
<dd><p>Hashes string into uint64-like integer number.</p>
</dd></dl>

</section>
<section id="module-deepfold.utils.import_utils">
<span id="deepfold-utils-import-utils-module"></span><h2>deepfold.utils.import_utils module<a class="headerlink" href="#module-deepfold.utils.import_utils" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.Param">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.import_utils.</span></span><span class="sig-name descname"><span class="pre">Param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">param:</span> <span class="pre">Union[torch.Tensor,</span> <span class="pre">List[torch.Tensor]],</span> <span class="pre">param_type:</span> <span class="pre">deepfold.utils.import_utils.ParamType</span> <span class="pre">=</span> <span class="pre">&lt;ParamType.Other:</span> <span class="pre">functools.partial(&lt;function</span> <span class="pre">ParamType.&lt;lambda&gt;</span> <span class="pre">at</span> <span class="pre">0x7f1e35c18820&gt;)&gt;,</span> <span class="pre">stacked:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">swap:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.import_utils.Param" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.Param.param">
<span class="sig-name descname"><span class="pre">param</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#deepfold.utils.import_utils.Param.param" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.Param.param_type">
<span class="sig-name descname"><span class="pre">param_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#deepfold.utils.import_utils.ParamType" title="deepfold.utils.import_utils.ParamType"><span class="pre">ParamType</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">functools.partial(&lt;function</span> <span class="pre">ParamType.&lt;lambda&gt;&gt;)</span></em><a class="headerlink" href="#deepfold.utils.import_utils.Param.param_type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.Param.stacked">
<span class="sig-name descname"><span class="pre">stacked</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#deepfold.utils.import_utils.Param.stacked" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.Param.swap">
<span class="sig-name descname"><span class="pre">swap</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#deepfold.utils.import_utils.Param.swap" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.ParamType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.import_utils.</span></span><span class="sig-name descname"><span class="pre">ParamType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.import_utils.ParamType" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.ParamType.LinearBiasMHA">
<span class="sig-name descname"><span class="pre">LinearBiasMHA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">functools.partial(&lt;function</span> <span class="pre">ParamType.&lt;lambda&gt;&gt;)</span></em><a class="headerlink" href="#deepfold.utils.import_utils.ParamType.LinearBiasMHA" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.ParamType.LinearMHAOutputWeight">
<span class="sig-name descname"><span class="pre">LinearMHAOutputWeight</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">functools.partial(&lt;function</span> <span class="pre">ParamType.&lt;lambda&gt;&gt;)</span></em><a class="headerlink" href="#deepfold.utils.import_utils.ParamType.LinearMHAOutputWeight" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.ParamType.LinearWeight">
<span class="sig-name descname"><span class="pre">LinearWeight</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">functools.partial(&lt;function</span> <span class="pre">ParamType.&lt;lambda&gt;&gt;)</span></em><a class="headerlink" href="#deepfold.utils.import_utils.ParamType.LinearWeight" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.ParamType.LinearWeightMHA">
<span class="sig-name descname"><span class="pre">LinearWeightMHA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">functools.partial(&lt;function</span> <span class="pre">ParamType.&lt;lambda&gt;&gt;)</span></em><a class="headerlink" href="#deepfold.utils.import_utils.ParamType.LinearWeightMHA" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.ParamType.LinearWeightOPM">
<span class="sig-name descname"><span class="pre">LinearWeightOPM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">functools.partial(&lt;function</span> <span class="pre">ParamType.&lt;lambda&gt;&gt;)</span></em><a class="headerlink" href="#deepfold.utils.import_utils.ParamType.LinearWeightOPM" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.ParamType.Other">
<span class="sig-name descname"><span class="pre">Other</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">functools.partial(&lt;function</span> <span class="pre">ParamType.&lt;lambda&gt;&gt;)</span></em><a class="headerlink" href="#deepfold.utils.import_utils.ParamType.Other" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.assign">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.import_utils.</span></span><span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">translation_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig_weights</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.import_utils.assign" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.import_jax_weights_">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.import_utils.</span></span><span class="sig-name descname"><span class="pre">import_jax_weights_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deepfold.modules.html#deepfold.modules.alphafold.AlphaFold" title="deepfold.modules.alphafold.AlphaFold"><span class="pre">AlphaFold</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">npz_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_multimer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_ptm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_templates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fuse_projection_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#deepfold.utils.import_utils.import_jax_weights_" title="Link to this definition">¶</a></dt>
<dd><p>Import AlphaFold JAX parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – AlphaFold model.</p></li>
<li><p><strong>npz_path</strong> – Path to an NPZ file.</p></li>
<li><p><strong>is_multimer</strong> – Whether multimer model or not.</p></li>
<li><p><strong>enable_ptm</strong> – Enable predicted aligned error related modules.</p></li>
<li><p><strong>enable_templates</strong> – Enable template related modules.</p></li>
<li><p><strong>fuse_projection_weights</strong> – Whether triangular multiplicative layers are fused or not.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.reshape_weight">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.import_utils.</span></span><span class="sig-name descname"><span class="pre">reshape_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#deepfold.utils.import_utils.reshape_weight" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.import_utils.stacked">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.import_utils.</span></span><span class="sig-name descname"><span class="pre">stacked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_dict_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.import_utils.stacked" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>param_dict_list</strong> – A list of (nested) Param dicts to stack. The structure of
each dict must be the identical (down to the ParamTypes of
“parallel” Params). There must be at least one dict
in the list.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-deepfold.utils.iter_utils">
<span id="deepfold-utils-iter-utils-module"></span><h2>deepfold.utils.iter_utils module<a class="headerlink" href="#module-deepfold.utils.iter_utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.iter_utils.all_equal">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.iter_utils.</span></span><span class="sig-name descname"><span class="pre">all_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#deepfold.utils.iter_utils.all_equal" title="Link to this definition">¶</a></dt>
<dd><p>Checks if all values in list are equal to each other.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.iter_utils.flatten_dict">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.iter_utils.</span></span><span class="sig-name descname"><span class="pre">flatten_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MutableMapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.iter_utils.flatten_dict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.iter_utils.list_zip">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.iter_utils.</span></span><span class="sig-name descname"><span class="pre">list_zip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arglists</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#deepfold.utils.iter_utils.list_zip" title="Link to this definition">¶</a></dt>
<dd><p>Transforms given columns into list of rows.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.iter_utils.map_dict_values">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.iter_utils.</span></span><span class="sig-name descname"><span class="pre">map_dict_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#deepfold.utils.iter_utils.map_dict_values" title="Link to this definition">¶</a></dt>
<dd><p>Maps dictionary values using given function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.iter_utils.slice_generator">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.iter_utils.</span></span><span class="sig-name descname"><span class="pre">slice_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deepfold.utils.iter_utils.slice_generator" title="Link to this definition">¶</a></dt>
<dd><p>Returns slice indices iterator from start to end.</p>
</dd></dl>

</section>
<section id="module-deepfold.utils.log_utils">
<span id="deepfold-utils-log-utils-module"></span><h2>deepfold.utils.log_utils module<a class="headerlink" href="#module-deepfold.utils.log_utils" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.log_utils.TqdmHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.log_utils.</span></span><span class="sig-name descname"><span class="pre">TqdmHandler</span></span><a class="headerlink" href="#deepfold.utils.log_utils.TqdmHandler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">StreamHandler</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.log_utils.TqdmHandler.emit">
<span class="sig-name descname"><span class="pre">emit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LogRecord</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#deepfold.utils.log_utils.TqdmHandler.emit" title="Link to this definition">¶</a></dt>
<dd><p>Emit a record.</p>
<p>If a formatter is specified, it is used to format the record.
The record is then written to the stream with a trailing newline.  If
exception information is present, it is formatted using
traceback.print_exception and appended to the stream.  If the stream
has an ‘encoding’ attribute, it is used to determine how to do the
output to the stream.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.log_utils.read_logs">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.log_utils.</span></span><span class="sig-name descname"><span class="pre">read_logs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_overridden_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#deepfold.utils.log_utils.read_logs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.log_utils.save_logs">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.log_utils.</span></span><span class="sig-name descname"><span class="pre">save_logs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#deepfold.utils.log_utils.save_logs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.log_utils.setup_logging">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.log_utils.</span></span><span class="sig-name descname"><span class="pre">setup_logging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PathLike</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#deepfold.utils.log_utils.setup_logging" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-deepfold.utils.precision">
<span id="deepfold-utils-precision-module"></span><h2>deepfold.utils.precision module<a class="headerlink" href="#module-deepfold.utils.precision" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.precision.is_fp16_enabled">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.precision.</span></span><span class="sig-name descname"><span class="pre">is_fp16_enabled</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#deepfold.utils.precision.is_fp16_enabled" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-deepfold.utils.random">
<span id="deepfold-utils-random-module"></span><h2>deepfold.utils.random module<a class="headerlink" href="#module-deepfold.utils.random" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.random.get_seed_from_string">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.random.</span></span><span class="sig-name descname"><span class="pre">get_seed_from_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#deepfold.utils.random.get_seed_from_string" title="Link to this definition">¶</a></dt>
<dd><p>Hashes input string and returns uint64-like integer seed value.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.random.get_seed_randomly">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.random.</span></span><span class="sig-name descname"><span class="pre">get_seed_randomly</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#deepfold.utils.random.get_seed_randomly" title="Link to this definition">¶</a></dt>
<dd><p>Returns truly pseduorandom uint64-like integer seed value.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.random.numpy_seed">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.random.</span></span><span class="sig-name descname"><span class="pre">numpy_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">additional_seeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.random.numpy_seed" title="Link to this definition">¶</a></dt>
<dd><p>Context manager which seeds the Numpy PRNG with the seed and restores the state.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.random.str_hash">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.random.</span></span><span class="sig-name descname"><span class="pre">str_hash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.random.str_hash" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-deepfold.utils.rigid_utils">
<span id="deepfold-utils-rigid-utils-module"></span><h2>deepfold.utils.rigid_utils module<a class="headerlink" href="#module-deepfold.utils.rigid_utils" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.rigid_utils.</span></span><span class="sig-name descname"><span class="pre">Rigid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class representing a rigid transformation. Little more than a wrapper
around two objects: a Rotation object and a [<a href="#id1"><span class="problematic" id="id2">*</span></a>, 3] translation
Designed to behave approximately like a single torch tensor with the
shape of the shared batch dimensions of its component parts.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.apply" title="Link to this definition">¶</a></dt>
<dd><p>Applies the transformation to a coordinate tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pts</strong> – A [<a href="#id3"><span class="problematic" id="id4">*</span></a>, 3] coordinate tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transformed points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.apply_rot_fn">
<span class="sig-name descname"><span class="pre">apply_rot_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.apply_rot_fn" title="Link to this definition">¶</a></dt>
<dd><p>Applies a Rotation -&gt; Rotation function to the stored rotation
object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn</strong> – A function of type Rotation -&gt; Rotation</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A transformation object with a transformed rotation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.apply_trans_fn">
<span class="sig-name descname"><span class="pre">apply_trans_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.apply_trans_fn" title="Link to this definition">¶</a></dt>
<dd><p>Applies a Tensor -&gt; Tensor function to the stored translation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn</strong> – A function of type Tensor -&gt; Tensor to be applied to the
translation</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A transformation object with a transformed translation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.cat">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.cat" title="Link to this definition">¶</a></dt>
<dd><p>Concatenates transformations along a new dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> – A list of T objects</p></li>
<li><p><strong>dim</strong> – The dimension along which the transformations should be
concatenated</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A concatenated transformation object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.compose">
<span class="sig-name descname"><span class="pre">compose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.compose" title="Link to this definition">¶</a></dt>
<dd><p>Composes the current rigid object with another.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> – Another Rigid object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The composition of the two transformations</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.compose_q_update_vec">
<span class="sig-name descname"><span class="pre">compose_q_update_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_update_vec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.compose_q_update_vec" title="Link to this definition">¶</a></dt>
<dd><p>Composes the transformation with a quaternion update vector of
shape [<a href="#id5"><span class="problematic" id="id6">*</span></a>, 6], where the final 6 columns represent the x, y, and
z values of a quaternion of form (1, x, y, z) followed by a 3D
translation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q_vec</strong> – The quaternion update vector.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The composed transformation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.cuda">
<span class="sig-name descname"><span class="pre">cuda</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.cuda" title="Link to this definition">¶</a></dt>
<dd><p>Moves the transformation object to GPU memory</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A version of the transformation on GPU</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.device" title="Link to this definition">¶</a></dt>
<dd><p>Returns the device on which the Rigid’s tensors are located.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The device on which the Rigid’s tensors are located</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.dtype" title="Link to this definition">¶</a></dt>
<dd><p>Returns the dtype of the Rigid tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dtype of the Rigid tensors</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.from_3_points">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_3_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_neg_x_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_xy_plane</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.from_3_points" title="Link to this definition">¶</a></dt>
<dd><p>Implements algorithm 21. Constructs transformations from sets of 3 points using the Gram-Schmidt algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_neg_x_axis</strong> – [<a href="#id7"><span class="problematic" id="id8">*</span></a>, 3] coordinates</p></li>
<li><p><strong>origin</strong> – [<a href="#id9"><span class="problematic" id="id10">*</span></a>, 3] coordinates used as frame origins</p></li>
<li><p><strong>p_xy_plane</strong> – [<a href="#id11"><span class="problematic" id="id12">*</span></a>, 3] coordinates</p></li>
<li><p><strong>eps</strong> – Small epsilon value</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A transformation object of shape [*]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.from_tensor_4x4">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_tensor_4x4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.from_tensor_4x4" title="Link to this definition">¶</a></dt>
<dd><p>Constructs a transformation from a homogenous transformation
tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>t</strong> – [<a href="#id13"><span class="problematic" id="id14">*</span></a>, 4, 4] homogenous transformation tensor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>T object with shape [*]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.from_tensor_7">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_tensor_7</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_quats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.from_tensor_7" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.get_rots">
<span class="sig-name descname"><span class="pre">get_rots</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.get_rots" title="Link to this definition">¶</a></dt>
<dd><p>Getter for the rotation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The rotation object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.get_trans">
<span class="sig-name descname"><span class="pre">get_trans</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.get_trans" title="Link to this definition">¶</a></dt>
<dd><p>Getter for the translation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The stored translation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.identity">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'quat'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.identity" title="Link to this definition">¶</a></dt>
<dd><p>Constructs an identity transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> – The desired shape</p></li>
<li><p><strong>dtype</strong> – The dtype of both internal tensors</p></li>
<li><p><strong>device</strong> – The device of both internal tensors</p></li>
<li><p><strong>requires_grad</strong> – Whether grad should be enabled for the internal tensors</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The identity transformation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.invert">
<span class="sig-name descname"><span class="pre">invert</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.invert" title="Link to this definition">¶</a></dt>
<dd><p>Inverts the transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The inverse transformation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.invert_apply">
<span class="sig-name descname"><span class="pre">invert_apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.invert_apply" title="Link to this definition">¶</a></dt>
<dd><p>Applies the inverse of the transformation to a coordinate tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pts</strong> – A [<a href="#id15"><span class="problematic" id="id16">*</span></a>, 3] coordinate tensor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transformed points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.make_transform_from_reference">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_transform_from_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ca_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.make_transform_from_reference" title="Link to this definition">¶</a></dt>
<dd><p>Returns a transformation object from reference coordinates.</p>
<p>Note that this method does not take care of symmetries. If you
provide the atom positions in the non-standard way, the N atom will
end up not at [-0.527250, 1.359329, 0.0] but instead at
[-0.527250, -1.359329, 0.0]. You need to take care of such cases in
your code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_xyz</strong> – A [<a href="#id17"><span class="problematic" id="id18">*</span></a>, 3] tensor of nitrogen xyz coordinates.</p></li>
<li><p><strong>ca_xyz</strong> – A [<a href="#id19"><span class="problematic" id="id20">*</span></a>, 3] tensor of carbon alpha xyz coordinates.</p></li>
<li><p><strong>c_xyz</strong> – A [<a href="#id21"><span class="problematic" id="id22">*</span></a>, 3] tensor of carbon xyz coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A transformation object. After applying the translation and
rotation to the reference backbone, the coordinates will
approximately equal to the input coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.map_tensor_fn">
<span class="sig-name descname"><span class="pre">map_tensor_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.map_tensor_fn" title="Link to this definition">¶</a></dt>
<dd><p>Apply a Tensor -&gt; Tensor function to underlying translation and
rotation tensors, mapping over the translation/rotation dimensions
respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn</strong> – A Tensor -&gt; Tensor function to be mapped over the Rigid</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transformed Rigid object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.scale_translation">
<span class="sig-name descname"><span class="pre">scale_translation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trans_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.scale_translation" title="Link to this definition">¶</a></dt>
<dd><p>Scales the translation by a constant factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trans_scale_factor</strong> – The constant factor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A transformation object with a scaled translation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Size</span></em><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.shape" title="Link to this definition">¶</a></dt>
<dd><p>Returns the shape of the shared dimensions of the rotation and
the translation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The shape of the transformation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.stop_rot_gradient">
<span class="sig-name descname"><span class="pre">stop_rot_gradient</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.stop_rot_gradient" title="Link to this definition">¶</a></dt>
<dd><p>Detaches the underlying rotation object</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A transformation object with detached rotations</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.to_tensor_4x4">
<span class="sig-name descname"><span class="pre">to_tensor_4x4</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.to_tensor_4x4" title="Link to this definition">¶</a></dt>
<dd><p>Converts a transformation to a homogenous transformation tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A [<a href="#id23"><span class="problematic" id="id24">*</span></a>, 4, 4] homogenous transformation tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.to_tensor_7">
<span class="sig-name descname"><span class="pre">to_tensor_7</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.to_tensor_7" title="Link to this definition">¶</a></dt>
<dd><p>Converts a transformation to a tensor with 7 final columns, four
for the quaternion followed by three for the translation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A [<a href="#id25"><span class="problematic" id="id26">*</span></a>, 7] tensor representation of the transformation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rigid.unsqueeze">
<span class="sig-name descname"><span class="pre">unsqueeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rigid.unsqueeze" title="Link to this definition">¶</a></dt>
<dd><p>Analogous to torch.unsqueeze. The dimension is relative to the
shared dimensions of the rotation/translation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> – A positive or negative dimension index.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The unsqueezed transformation.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.rigid_utils.</span></span><span class="sig-name descname"><span class="pre">Rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rot_mats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_quats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A 3D rotation. Depending on how the object is initialized, the
rotation is represented by either a rotation matrix or a
quaternion, though both formats are made available by helper functions.
To simplify gradient computation, the underlying format of the
rotation cannot be changed in-place. Like Rigid, the class is designed
to mimic the behavior of a torch Tensor, almost as if each Rotation
object were a tensor of rotations, in one format or another.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.apply" title="Link to this definition">¶</a></dt>
<dd><p>Apply the current Rotation as a rotation matrix to a set of 3D
coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pts</strong> – A [<a href="#id27"><span class="problematic" id="id28">*</span></a>, 3] set of points</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[<a href="#id29"><span class="problematic" id="id30">*</span></a>, 3] rotated points</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.cat">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.cat" title="Link to this definition">¶</a></dt>
<dd><p>Concatenates rotations along one of the batch dimensions. Analogous
to torch.cat().</p>
<p>Note that the output of this operation is always a rotation matrix,
regardless of the format of input rotations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rs</strong> – A list of rotation objects</p></li>
<li><p><strong>dim</strong> – The dimension along which the rotations should be
concatenated</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A concatenated Rotation object in rotation matrix format</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.compose_q">
<span class="sig-name descname"><span class="pre">compose_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_quats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.compose_q" title="Link to this definition">¶</a></dt>
<dd><p>Compose the quaternions of the current Rotation object with those
of another.</p>
<p>Depending on whether either Rotation was initialized with
quaternions, this function may call torch.linalg.eigh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> – An update rotation object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An updated rotation object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.compose_q_update_vec">
<span class="sig-name descname"><span class="pre">compose_q_update_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_update_vec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_quats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.compose_q_update_vec" title="Link to this definition">¶</a></dt>
<dd><p>Returns a new quaternion Rotation after updating the current
object’s underlying rotation with a quaternion update, formatted
as a [<a href="#id31"><span class="problematic" id="id32">*</span></a>, 3] tensor whose final three columns represent x, y, z such
that (1, x, y, z) is the desired (not necessarily unit) quaternion
update.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_update_vec</strong> – A [<a href="#id33"><span class="problematic" id="id34">*</span></a>, 3] quaternion update tensor</p></li>
<li><p><strong>normalize_quats</strong> – Whether to normalize the output quaternion</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An updated Rotation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.compose_r">
<span class="sig-name descname"><span class="pre">compose_r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.compose_r" title="Link to this definition">¶</a></dt>
<dd><p>Compose the rotation matrices of the current Rotation object with
those of another.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> – An update rotation object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An updated rotation object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.cuda">
<span class="sig-name descname"><span class="pre">cuda</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.cuda" title="Link to this definition">¶</a></dt>
<dd><p>Analogous to the cuda() method of torch Tensors</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A copy of the Rotation in CUDA memory</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.detach">
<span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.detach" title="Link to this definition">¶</a></dt>
<dd><p>Returns a copy of the Rotation whose underlying Tensor has been
detached from its torch graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A copy of the Rotation whose underlying Tensor has been detached
from its torch graph</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.device" title="Link to this definition">¶</a></dt>
<dd><p>The device of the underlying rotation</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The device of the underlying rotation</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.dtype" title="Link to this definition">¶</a></dt>
<dd><p>Returns the dtype of the underlying rotation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dtype of the underlying rotation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.get_cur_rot">
<span class="sig-name descname"><span class="pre">get_cur_rot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.get_cur_rot" title="Link to this definition">¶</a></dt>
<dd><p>Return the underlying rotation in its current form</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The stored rotation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.get_quats">
<span class="sig-name descname"><span class="pre">get_quats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.get_quats" title="Link to this definition">¶</a></dt>
<dd><p>Returns the underlying rotation as a quaternion tensor.</p>
<p>Depending on whether the Rotation was initialized with a
quaternion, this function may call torch.linalg.eigh.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The rotation as a quaternion tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.get_rot_mats">
<span class="sig-name descname"><span class="pre">get_rot_mats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.get_rot_mats" title="Link to this definition">¶</a></dt>
<dd><p>Returns the underlying rotation as a rotation matrix tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The rotation as a rotation matrix tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.identity">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'quat'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.identity" title="Link to this definition">¶</a></dt>
<dd><p>Returns an identity Rotation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> – The “shape” of the resulting Rotation object. See documentation
for the shape property</p></li>
<li><p><strong>dtype</strong> – The torch dtype for the rotation</p></li>
<li><p><strong>device</strong> – The torch device for the new rotation</p></li>
<li><p><strong>requires_grad</strong> – Whether the underlying tensors in the new rotation object
should require gradient computation</p></li>
<li><p><strong>fmt</strong> – One of “quat” or “rot_mat”. Determines the underlying format
of the new object’s rotation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new identity rotation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.invert">
<span class="sig-name descname"><span class="pre">invert</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.invert" title="Link to this definition">¶</a></dt>
<dd><p>Returns the inverse of the current Rotation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The inverse of the current Rotation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.invert_apply">
<span class="sig-name descname"><span class="pre">invert_apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.invert_apply" title="Link to this definition">¶</a></dt>
<dd><p>The inverse of the apply() method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pts</strong> – A [<a href="#id35"><span class="problematic" id="id36">*</span></a>, 3] set of points</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[<a href="#id37"><span class="problematic" id="id38">*</span></a>, 3] inverse-rotated points</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.map_tensor_fn">
<span class="sig-name descname"><span class="pre">map_tensor_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.map_tensor_fn" title="Link to this definition">¶</a></dt>
<dd><p>Apply a Tensor -&gt; Tensor function to underlying rotation tensors,
mapping over the rotation dimension(s). Can be used e.g. to sum out
a one-hot batch dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn</strong> – A Tensor -&gt; Tensor function to be mapped over the Rotation</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transformed Rotation object</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.requires_grad">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">requires_grad</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.requires_grad" title="Link to this definition">¶</a></dt>
<dd><p>Returns the requires_grad property of the underlying rotation</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The requires_grad property of the underlying tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Size</span></em><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.shape" title="Link to this definition">¶</a></dt>
<dd><p>Returns the virtual shape of the rotation object. This shape is
defined as the batch dimensions of the underlying rotation matrix
or quaternion. If the Rotation was initialized with a [10, 3, 3]
rotation matrix tensor, for example, the resulting shape would be
[10].</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The virtual shape of the rotation object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.to" title="Link to this definition">¶</a></dt>
<dd><p>Analogous to the to() method of torch Tensors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – A torch device</p></li>
<li><p><strong>dtype</strong> – A torch dtype</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A copy of the Rotation using the new device and dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.Rotation.unsqueeze">
<span class="sig-name descname"><span class="pre">unsqueeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.Rotation.unsqueeze" title="Link to this definition">¶</a></dt>
<dd><p>Analogous to torch.unsqueeze. The dimension is relative to the
shape of the Rotation object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> – A positive or negative dimension index.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The unsqueezed Rotation.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.identity_quats">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.rigid_utils.</span></span><span class="sig-name descname"><span class="pre">identity_quats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.identity_quats" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.identity_rot_mats">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.rigid_utils.</span></span><span class="sig-name descname"><span class="pre">identity_rot_mats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.identity_rot_mats" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.identity_trans">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.rigid_utils.</span></span><span class="sig-name descname"><span class="pre">identity_trans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.identity_trans" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.invert_quat">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.rigid_utils.</span></span><span class="sig-name descname"><span class="pre">invert_quat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.rigid_utils.invert_quat" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.invert_rot_mat">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.rigid_utils.</span></span><span class="sig-name descname"><span class="pre">invert_rot_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rot_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.rigid_utils.invert_rot_mat" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.quat_multiply">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.rigid_utils.</span></span><span class="sig-name descname"><span class="pre">quat_multiply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quat1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quat2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.rigid_utils.quat_multiply" title="Link to this definition">¶</a></dt>
<dd><p>Multiply a quaternion by another quaternion.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.quat_multiply_by_vec">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.rigid_utils.</span></span><span class="sig-name descname"><span class="pre">quat_multiply_by_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.rigid_utils.quat_multiply_by_vec" title="Link to this definition">¶</a></dt>
<dd><p>Multiply a quaternion by a pure-vector quaternion.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.quat_to_rot">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.rigid_utils.</span></span><span class="sig-name descname"><span class="pre">quat_to_rot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.quat_to_rot" title="Link to this definition">¶</a></dt>
<dd><p>Converts a quaternion to a rotation matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>quat</strong> – [<a href="#id39"><span class="problematic" id="id40">*</span></a>, 4] quaternions</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[<a href="#id41"><span class="problematic" id="id42">*</span></a>, 3, 3] rotation matrices</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.rot_matmul">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.rigid_utils.</span></span><span class="sig-name descname"><span class="pre">rot_matmul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.rot_matmul" title="Link to this definition">¶</a></dt>
<dd><p>Performs matrix multiplication of two rotation matrix tensors. Written
out by hand to avoid AMP downcasting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – [<a href="#id43"><span class="problematic" id="id44">*</span></a>, 3, 3] left multiplicand</p></li>
<li><p><strong>b</strong> – [<a href="#id45"><span class="problematic" id="id46">*</span></a>, 3, 3] right multiplicand</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The product ab</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.rot_to_quat">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.rigid_utils.</span></span><span class="sig-name descname"><span class="pre">rot_to_quat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.rot_to_quat" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.rigid_utils.rot_vec_mul">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.rigid_utils.</span></span><span class="sig-name descname"><span class="pre">rot_vec_mul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.rigid_utils.rot_vec_mul" title="Link to this definition">¶</a></dt>
<dd><p>Applies a rotation to a vector. Written out by hand to avoid transfer
to avoid AMP downcasting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> – [<a href="#id47"><span class="problematic" id="id48">*</span></a>, 3, 3] rotation matrices</p></li>
<li><p><strong>t</strong> – [<a href="#id49"><span class="problematic" id="id50">*</span></a>, 3] coordinate tensors</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[<a href="#id51"><span class="problematic" id="id52">*</span></a>, 3] rotated coordinates</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-deepfold.utils.script_utils">
<span id="deepfold-utils-script-utils-module"></span><h2>deepfold.utils.script_utils module<a class="headerlink" href="#module-deepfold.utils.script_utils" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.script_utils.get_basename">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.script_utils.</span></span><span class="sig-name descname"><span class="pre">get_basename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.script_utils.get_basename" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.script_utils.make_output_directory">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.script_utils.</span></span><span class="sig-name descname"><span class="pre">make_output_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.script_utils.make_output_directory" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.script_utils.parse_fasta">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.script_utils.</span></span><span class="sig-name descname"><span class="pre">parse_fasta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fasta_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.script_utils.parse_fasta" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-deepfold.utils.swa_utils">
<span id="deepfold-utils-swa-utils-module"></span><h2>deepfold.utils.swa_utils module<a class="headerlink" href="#module-deepfold.utils.swa_utils" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.swa_utils.AlphaFoldSWA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.swa_utils.</span></span><span class="sig-name descname"><span class="pre">AlphaFoldSWA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alphafold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deepfold.modules.html#deepfold.modules.alphafold.AlphaFold" title="deepfold.modules.alphafold.AlphaFold"><span class="pre">AlphaFold</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">enabled</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.swa_utils.AlphaFoldSWA" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Weight averaging wrapper.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.swa_utils.AlphaFoldSWA.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.swa_utils.AlphaFoldSWA.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.swa_utils.AlphaFoldSWA.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deepfold.modules.html#deepfold.modules.alphafold.AlphaFold" title="deepfold.modules.alphafold.AlphaFold"><span class="pre">AlphaFold</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#deepfold.utils.swa_utils.AlphaFoldSWA.update" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.swa_utils.swa_avg_fn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.swa_utils.</span></span><span class="sig-name descname"><span class="pre">swa_avg_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decay_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.swa_utils.swa_avg_fn" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Averaging function for EMA with configurable decay rate.</p>
<p>Suppl. ‘1.11.7 Evaluator setup’.</p>
</dd></dl>

</section>
<section id="module-deepfold.utils.tensor_utils">
<span id="deepfold-utils-tensor-utils-module"></span><h2>deepfold.utils.tensor_utils module<a class="headerlink" href="#module-deepfold.utils.tensor_utils" title="Link to this heading">¶</a></h2>
<p>Utilities related to tensor operations.</p>
<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.tensor_utils.add">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.tensor_utils.add" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.tensor_utils.array_tree_map">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">array_tree_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_type=&lt;class</span> <span class="pre">'numpy.ndarray'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.tensor_utils.array_tree_map" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.tensor_utils.batched_gather">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">batched_gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_batch_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.tensor_utils.batched_gather" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.tensor_utils.collate">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">collate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#deepfold.utils.tensor_utils.collate" title="Link to this definition">¶</a></dt>
<dd><p>Converts list of samples into a batch dict.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.tensor_utils.dict_map">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">dict_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deepfold.utils.tensor_utils.dict_map" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.tensor_utils.dict_multimap">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">dict_multimap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dicts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deepfold.utils.tensor_utils.dict_multimap" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.tensor_utils.flatten_final_dims">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">flatten_final_dims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.tensor_utils.flatten_final_dims" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.tensor_utils.masked_mean">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">masked_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.tensor_utils.masked_mean" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.tensor_utils.one_hot">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">one_hot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.tensor_utils.one_hot" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.tensor_utils.permute_final_dims">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">permute_final_dims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.tensor_utils.permute_final_dims" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.tensor_utils.pts_to_distogram">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">pts_to_distogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.2325</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_bin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">21.6875</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.tensor_utils.pts_to_distogram" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.tensor_utils.tensor_tree_map">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">tensor_tree_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_type=&lt;class</span> <span class="pre">'torch.Tensor'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.tensor_utils.tensor_tree_map" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.tensor_utils.tree_map">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">tree_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#deepfold.utils.tensor_utils.tree_map" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">tree_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">tree_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span></dt>
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.tensor_utils.</span></span><span class="sig-name descname"><span class="pre">tree_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">T</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span></dt>
<dd></dd></dl>

</section>
<section id="module-deepfold.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-deepfold.utils" title="Link to this heading">¶</a></h2>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="deepfold.utils.geometry.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">deepfold.utils.geometry package</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="deepfold.train.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">deepfold.train package</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Paek et al.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">deepfold.utils package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-deepfold.utils.checkpoint_utils">deepfold.utils.checkpoint_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.checkpoint_utils.map_init_state_dicts"><code class="docutils literal notranslate"><span class="pre">map_init_state_dicts()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.checkpoint_utils.resume_checkpoint"><code class="docutils literal notranslate"><span class="pre">resume_checkpoint()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.checkpoint_utils.resume_from_latest_checkpoint"><code class="docutils literal notranslate"><span class="pre">resume_from_latest_checkpoint()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.checkpoint_utils.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">save_checkpoint()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.checkpoint_utils.save_last_checkpoint"><code class="docutils literal notranslate"><span class="pre">save_last_checkpoint()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.checkpoint_utils.save_val_checkpoint"><code class="docutils literal notranslate"><span class="pre">save_val_checkpoint()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.chunk_utils">deepfold.utils.chunk_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.chunk_utils.chunk_layer"><code class="docutils literal notranslate"><span class="pre">chunk_layer()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.crop_utils">deepfold.utils.crop_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.crop_utils.unpad_to_schema_shape_"><code class="docutils literal notranslate"><span class="pre">unpad_to_schema_shape_()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.datetime_utils">deepfold.utils.datetime_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.datetime_utils.datetime_from_string"><code class="docutils literal notranslate"><span class="pre">datetime_from_string()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.datetime_utils.datetime_to_string"><code class="docutils literal notranslate"><span class="pre">datetime_to_string()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.datetime_utils.get_timestamp_string"><code class="docutils literal notranslate"><span class="pre">get_timestamp_string()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.dist_utils">deepfold.utils.dist_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.dist_utils.get_pad_size"><code class="docutils literal notranslate"><span class="pre">get_pad_size()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.dist_utils.pad_tensor"><code class="docutils literal notranslate"><span class="pre">pad_tensor()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.feats_utils">deepfold.utils.feats_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.feats_utils.crop_a3m_string"><code class="docutils literal notranslate"><span class="pre">crop_a3m_string()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.feats_utils.crop_features"><code class="docutils literal notranslate"><span class="pre">crop_features()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.file_utils">deepfold.utils.file_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.file_utils.dump_pickle"><code class="docutils literal notranslate"><span class="pre">dump_pickle()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.file_utils.find_paths"><code class="docutils literal notranslate"><span class="pre">find_paths()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.file_utils.load_pickle"><code class="docutils literal notranslate"><span class="pre">load_pickle()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.file_utils.read_text"><code class="docutils literal notranslate"><span class="pre">read_text()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.hash_utils">deepfold.utils.hash_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.hash_utils.hash_string_into_number"><code class="docutils literal notranslate"><span class="pre">hash_string_into_number()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.import_utils">deepfold.utils.import_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.import_utils.Param"><code class="docutils literal notranslate"><span class="pre">Param</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.import_utils.Param.param"><code class="docutils literal notranslate"><span class="pre">Param.param</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.import_utils.Param.param_type"><code class="docutils literal notranslate"><span class="pre">Param.param_type</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.import_utils.Param.stacked"><code class="docutils literal notranslate"><span class="pre">Param.stacked</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.import_utils.Param.swap"><code class="docutils literal notranslate"><span class="pre">Param.swap</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepfold.utils.import_utils.ParamType"><code class="docutils literal notranslate"><span class="pre">ParamType</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.import_utils.ParamType.LinearBiasMHA"><code class="docutils literal notranslate"><span class="pre">ParamType.LinearBiasMHA</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.import_utils.ParamType.LinearMHAOutputWeight"><code class="docutils literal notranslate"><span class="pre">ParamType.LinearMHAOutputWeight</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.import_utils.ParamType.LinearWeight"><code class="docutils literal notranslate"><span class="pre">ParamType.LinearWeight</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.import_utils.ParamType.LinearWeightMHA"><code class="docutils literal notranslate"><span class="pre">ParamType.LinearWeightMHA</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.import_utils.ParamType.LinearWeightOPM"><code class="docutils literal notranslate"><span class="pre">ParamType.LinearWeightOPM</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.import_utils.ParamType.Other"><code class="docutils literal notranslate"><span class="pre">ParamType.Other</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepfold.utils.import_utils.assign"><code class="docutils literal notranslate"><span class="pre">assign()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.import_utils.import_jax_weights_"><code class="docutils literal notranslate"><span class="pre">import_jax_weights_()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.import_utils.reshape_weight"><code class="docutils literal notranslate"><span class="pre">reshape_weight()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.import_utils.stacked"><code class="docutils literal notranslate"><span class="pre">stacked()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.iter_utils">deepfold.utils.iter_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.iter_utils.all_equal"><code class="docutils literal notranslate"><span class="pre">all_equal()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.iter_utils.flatten_dict"><code class="docutils literal notranslate"><span class="pre">flatten_dict()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.iter_utils.list_zip"><code class="docutils literal notranslate"><span class="pre">list_zip()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.iter_utils.map_dict_values"><code class="docutils literal notranslate"><span class="pre">map_dict_values()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.iter_utils.slice_generator"><code class="docutils literal notranslate"><span class="pre">slice_generator()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.log_utils">deepfold.utils.log_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.log_utils.TqdmHandler"><code class="docutils literal notranslate"><span class="pre">TqdmHandler</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.log_utils.TqdmHandler.emit"><code class="docutils literal notranslate"><span class="pre">TqdmHandler.emit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepfold.utils.log_utils.read_logs"><code class="docutils literal notranslate"><span class="pre">read_logs()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.log_utils.save_logs"><code class="docutils literal notranslate"><span class="pre">save_logs()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.log_utils.setup_logging"><code class="docutils literal notranslate"><span class="pre">setup_logging()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.precision">deepfold.utils.precision module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.precision.is_fp16_enabled"><code class="docutils literal notranslate"><span class="pre">is_fp16_enabled()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.random">deepfold.utils.random module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.random.get_seed_from_string"><code class="docutils literal notranslate"><span class="pre">get_seed_from_string()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.random.get_seed_randomly"><code class="docutils literal notranslate"><span class="pre">get_seed_randomly()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.random.numpy_seed"><code class="docutils literal notranslate"><span class="pre">numpy_seed()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.random.str_hash"><code class="docutils literal notranslate"><span class="pre">str_hash()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.rigid_utils">deepfold.utils.rigid_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid"><code class="docutils literal notranslate"><span class="pre">Rigid</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.apply"><code class="docutils literal notranslate"><span class="pre">Rigid.apply()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.apply_rot_fn"><code class="docutils literal notranslate"><span class="pre">Rigid.apply_rot_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.apply_trans_fn"><code class="docutils literal notranslate"><span class="pre">Rigid.apply_trans_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.cat"><code class="docutils literal notranslate"><span class="pre">Rigid.cat()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.compose"><code class="docutils literal notranslate"><span class="pre">Rigid.compose()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.compose_q_update_vec"><code class="docutils literal notranslate"><span class="pre">Rigid.compose_q_update_vec()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.cuda"><code class="docutils literal notranslate"><span class="pre">Rigid.cuda()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.device"><code class="docutils literal notranslate"><span class="pre">Rigid.device</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.dtype"><code class="docutils literal notranslate"><span class="pre">Rigid.dtype</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.from_3_points"><code class="docutils literal notranslate"><span class="pre">Rigid.from_3_points()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.from_tensor_4x4"><code class="docutils literal notranslate"><span class="pre">Rigid.from_tensor_4x4()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.from_tensor_7"><code class="docutils literal notranslate"><span class="pre">Rigid.from_tensor_7()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.get_rots"><code class="docutils literal notranslate"><span class="pre">Rigid.get_rots()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.get_trans"><code class="docutils literal notranslate"><span class="pre">Rigid.get_trans()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.identity"><code class="docutils literal notranslate"><span class="pre">Rigid.identity()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.invert"><code class="docutils literal notranslate"><span class="pre">Rigid.invert()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.invert_apply"><code class="docutils literal notranslate"><span class="pre">Rigid.invert_apply()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.make_transform_from_reference"><code class="docutils literal notranslate"><span class="pre">Rigid.make_transform_from_reference()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Rigid.map_tensor_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.scale_translation"><code class="docutils literal notranslate"><span class="pre">Rigid.scale_translation()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.shape"><code class="docutils literal notranslate"><span class="pre">Rigid.shape</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.stop_rot_gradient"><code class="docutils literal notranslate"><span class="pre">Rigid.stop_rot_gradient()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.to_tensor_4x4"><code class="docutils literal notranslate"><span class="pre">Rigid.to_tensor_4x4()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.to_tensor_7"><code class="docutils literal notranslate"><span class="pre">Rigid.to_tensor_7()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rigid.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Rigid.unsqueeze()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation"><code class="docutils literal notranslate"><span class="pre">Rotation</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.apply"><code class="docutils literal notranslate"><span class="pre">Rotation.apply()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.cat"><code class="docutils literal notranslate"><span class="pre">Rotation.cat()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.compose_q"><code class="docutils literal notranslate"><span class="pre">Rotation.compose_q()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.compose_q_update_vec"><code class="docutils literal notranslate"><span class="pre">Rotation.compose_q_update_vec()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.compose_r"><code class="docutils literal notranslate"><span class="pre">Rotation.compose_r()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.cuda"><code class="docutils literal notranslate"><span class="pre">Rotation.cuda()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.detach"><code class="docutils literal notranslate"><span class="pre">Rotation.detach()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.device"><code class="docutils literal notranslate"><span class="pre">Rotation.device</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.dtype"><code class="docutils literal notranslate"><span class="pre">Rotation.dtype</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.get_cur_rot"><code class="docutils literal notranslate"><span class="pre">Rotation.get_cur_rot()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.get_quats"><code class="docutils literal notranslate"><span class="pre">Rotation.get_quats()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.get_rot_mats"><code class="docutils literal notranslate"><span class="pre">Rotation.get_rot_mats()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.identity"><code class="docutils literal notranslate"><span class="pre">Rotation.identity()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.invert"><code class="docutils literal notranslate"><span class="pre">Rotation.invert()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.invert_apply"><code class="docutils literal notranslate"><span class="pre">Rotation.invert_apply()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Rotation.map_tensor_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.requires_grad"><code class="docutils literal notranslate"><span class="pre">Rotation.requires_grad</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.shape"><code class="docutils literal notranslate"><span class="pre">Rotation.shape</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.to"><code class="docutils literal notranslate"><span class="pre">Rotation.to()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.Rotation.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Rotation.unsqueeze()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.identity_quats"><code class="docutils literal notranslate"><span class="pre">identity_quats()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.identity_rot_mats"><code class="docutils literal notranslate"><span class="pre">identity_rot_mats()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.identity_trans"><code class="docutils literal notranslate"><span class="pre">identity_trans()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.invert_quat"><code class="docutils literal notranslate"><span class="pre">invert_quat()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.invert_rot_mat"><code class="docutils literal notranslate"><span class="pre">invert_rot_mat()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.quat_multiply"><code class="docutils literal notranslate"><span class="pre">quat_multiply()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.quat_multiply_by_vec"><code class="docutils literal notranslate"><span class="pre">quat_multiply_by_vec()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.quat_to_rot"><code class="docutils literal notranslate"><span class="pre">quat_to_rot()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.rot_matmul"><code class="docutils literal notranslate"><span class="pre">rot_matmul()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.rot_to_quat"><code class="docutils literal notranslate"><span class="pre">rot_to_quat()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.rigid_utils.rot_vec_mul"><code class="docutils literal notranslate"><span class="pre">rot_vec_mul()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.script_utils">deepfold.utils.script_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.script_utils.get_basename"><code class="docutils literal notranslate"><span class="pre">get_basename()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.script_utils.make_output_directory"><code class="docutils literal notranslate"><span class="pre">make_output_directory()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.script_utils.parse_fasta"><code class="docutils literal notranslate"><span class="pre">parse_fasta()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.swa_utils">deepfold.utils.swa_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.swa_utils.AlphaFoldSWA"><code class="docutils literal notranslate"><span class="pre">AlphaFoldSWA</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.swa_utils.AlphaFoldSWA.forward"><code class="docutils literal notranslate"><span class="pre">AlphaFoldSWA.forward()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.swa_utils.AlphaFoldSWA.update"><code class="docutils literal notranslate"><span class="pre">AlphaFoldSWA.update()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepfold.utils.swa_utils.swa_avg_fn"><code class="docutils literal notranslate"><span class="pre">swa_avg_fn</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.tensor_utils">deepfold.utils.tensor_utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.tensor_utils.add"><code class="docutils literal notranslate"><span class="pre">add()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.tensor_utils.array_tree_map"><code class="docutils literal notranslate"><span class="pre">array_tree_map()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.tensor_utils.batched_gather"><code class="docutils literal notranslate"><span class="pre">batched_gather()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.tensor_utils.collate"><code class="docutils literal notranslate"><span class="pre">collate()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.tensor_utils.dict_map"><code class="docutils literal notranslate"><span class="pre">dict_map()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.tensor_utils.dict_multimap"><code class="docutils literal notranslate"><span class="pre">dict_multimap()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.tensor_utils.flatten_final_dims"><code class="docutils literal notranslate"><span class="pre">flatten_final_dims()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.tensor_utils.masked_mean"><code class="docutils literal notranslate"><span class="pre">masked_mean()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.tensor_utils.one_hot"><code class="docutils literal notranslate"><span class="pre">one_hot()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.tensor_utils.permute_final_dims"><code class="docutils literal notranslate"><span class="pre">permute_final_dims()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.tensor_utils.pts_to_distogram"><code class="docutils literal notranslate"><span class="pre">pts_to_distogram()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.tensor_utils.tensor_tree_map"><code class="docutils literal notranslate"><span class="pre">tensor_tree_map()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.tensor_utils.tree_map"><code class="docutils literal notranslate"><span class="pre">tree_map()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils">Module contents</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=4e2eecee"></script>
    </body>
</html>