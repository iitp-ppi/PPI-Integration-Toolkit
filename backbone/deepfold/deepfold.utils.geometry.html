<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>deepfold.utils.geometry package - IITP PPI 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">IITP PPI 0.0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">IITP PPI 0.0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/backbone/deepfold/deepfold.utils.geometry.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="deepfold-utils-geometry-package">
<h1>deepfold.utils.geometry package<a class="headerlink" href="#deepfold-utils-geometry-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-deepfold.utils.geometry.quat_rigid">
<span id="deepfold-utils-geometry-quat-rigid-module"></span><h2>deepfold.utils.geometry.quat_rigid module<a class="headerlink" href="#module-deepfold.utils.geometry.quat_rigid" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.geometry.quat_rigid.QuatRigid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.quat_rigid.</span></span><span class="sig-name descname"><span class="pre">QuatRigid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_hidden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_quat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.quat_rigid.QuatRigid" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.quat_rigid.QuatRigid.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">activations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.quat_rigid.QuatRigid.forward" title="Link to this definition">¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-deepfold.utils.geometry.rigid_matrix_vector">
<span id="deepfold-utils-geometry-rigid-matrix-vector-module"></span><h2>deepfold.utils.geometry.rigid_matrix_vector module<a class="headerlink" href="#module-deepfold.utils.geometry.rigid_matrix_vector" title="Link to this heading">¶</a></h2>
<p>Rigid3Array Transformations represented by a Matrix and a Vector.</p>
<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.rigid_matrix_vector.</span></span><span class="sig-name descname"><span class="pre">Rigid3Array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rotation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">translation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Rigid Transformation, i.e. element of special euclidean group.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.apply" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.apply_inverse_to_point">
<span class="sig-name descname"><span class="pre">apply_inverse_to_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.apply_inverse_to_point" title="Link to this definition">¶</a></dt>
<dd><p>Apply inverse Rigid3Array transform to point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.apply_to_point">
<span class="sig-name descname"><span class="pre">apply_to_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.apply_to_point" title="Link to this definition">¶</a></dt>
<dd><p>Apply Rigid3Array transform to point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.cat">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rigids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.cat" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.compose">
<span class="sig-name descname"><span class="pre">compose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other_rigid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.compose" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.compose_rotation">
<span class="sig-name descname"><span class="pre">compose_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other_rotation</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.compose_rotation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.cuda">
<span class="sig-name descname"><span class="pre">cuda</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.cuda" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.device" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.dtype" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.from_array">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.from_array" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.from_array4x4">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_array4x4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.from_array4x4" title="Link to this definition">¶</a></dt>
<dd><p>Construct Rigid3Array from homogeneous 4x4 array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.from_tensor_4x4">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_tensor_4x4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.from_tensor_4x4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.identity">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.identity" title="Link to this definition">¶</a></dt>
<dd><p>Return identity Rigid3Array of given shape.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.inverse">
<span class="sig-name descname"><span class="pre">inverse</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.inverse" title="Link to this definition">¶</a></dt>
<dd><p>Return Rigid3Array corresponding to inverse transform.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.invert_apply">
<span class="sig-name descname"><span class="pre">invert_apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.invert_apply" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.map_tensor_fn">
<span class="sig-name descname"><span class="pre">map_tensor_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.map_tensor_fn" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.reshape">
<span class="sig-name descname"><span class="pre">reshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_shape</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.reshape" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.rotation">
<span class="sig-name descname"><span class="pre">rotation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></em><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.rotation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.scale_translation">
<span class="sig-name descname"><span class="pre">scale_translation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.scale_translation" title="Link to this definition">¶</a></dt>
<dd><p>Scale translation in Rigid3Array by ‘factor’.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Size</span></em><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.shape" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.stop_rot_gradient">
<span class="sig-name descname"><span class="pre">stop_rot_gradient</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.stop_rot_gradient" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.to_tensor">
<span class="sig-name descname"><span class="pre">to_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.to_tensor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.to_tensor_4x4">
<span class="sig-name descname"><span class="pre">to_tensor_4x4</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.to_tensor_4x4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.translation">
<span class="sig-name descname"><span class="pre">translation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></em><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.translation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.unsqueeze">
<span class="sig-name descname"><span class="pre">unsqueeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.unsqueeze" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-deepfold.utils.geometry.rotation_matrix">
<span id="deepfold-utils-geometry-rotation-matrix-module"></span><h2>deepfold.utils.geometry.rotation_matrix module<a class="headerlink" href="#module-deepfold.utils.geometry.rotation_matrix" title="Link to this heading">¶</a></h2>
<p>Rot3Array Matrix Class.</p>
<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.rotation_matrix.</span></span><span class="sig-name descname"><span class="pre">Rot3Array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Rot3Array Matrix in 3 dimensional Space implemented as struct of arrays.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.apply_inverse_to_point">
<span class="sig-name descname"><span class="pre">apply_inverse_to_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.apply_inverse_to_point" title="Link to this definition">¶</a></dt>
<dd><p>Applies inverse Rot3Array to point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.apply_to_point">
<span class="sig-name descname"><span class="pre">apply_to_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.apply_to_point" title="Link to this definition">¶</a></dt>
<dd><p>Applies Rot3Array to point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.cat">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.cat" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.from_array">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.from_array" title="Link to this definition">¶</a></dt>
<dd><p>Construct Rot3Array Matrix from array of shape. […, 3, 3].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.from_quaternion">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_quaternion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.from_quaternion" title="Link to this definition">¶</a></dt>
<dd><p>Construct Rot3Array from components of quaternion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.from_two_vectors">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_two_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.from_two_vectors" title="Link to this definition">¶</a></dt>
<dd><p>Construct Rot3Array from two Vectors.</p>
<p>Rot3Array is constructed such that in the corresponding frame ‘e0’ lies on
the positive x-Axis and ‘e1’ lies in the xy plane with positive sign of y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Vector</p></li>
<li><p><strong>e1</strong> – Vector</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rot3Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.identity">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.identity" title="Link to this definition">¶</a></dt>
<dd><p>Returns identity of given shape.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.inverse">
<span class="sig-name descname"><span class="pre">inverse</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.inverse" title="Link to this definition">¶</a></dt>
<dd><p>Returns inverse of Rot3Array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.map_tensor_fn">
<span class="sig-name descname"><span class="pre">map_tensor_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.map_tensor_fn" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.reshape">
<span class="sig-name descname"><span class="pre">reshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.reshape" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.stop_gradient">
<span class="sig-name descname"><span class="pre">stop_gradient</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.stop_gradient" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.to_tensor">
<span class="sig-name descname"><span class="pre">to_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.to_tensor" title="Link to this definition">¶</a></dt>
<dd><p>Convert Rot3Array to array of shape […, 3, 3].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.unsqueeze">
<span class="sig-name descname"><span class="pre">unsqueeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.unsqueeze" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.xx">
<span class="sig-name descname"><span class="pre">xx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.xx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.xy">
<span class="sig-name descname"><span class="pre">xy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.xy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.xz">
<span class="sig-name descname"><span class="pre">xz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.xz" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.yx">
<span class="sig-name descname"><span class="pre">yx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.yx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.yy">
<span class="sig-name descname"><span class="pre">yy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.yy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.yz">
<span class="sig-name descname"><span class="pre">yz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.yz" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.zx">
<span class="sig-name descname"><span class="pre">zx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.zx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.zy">
<span class="sig-name descname"><span class="pre">zy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.zy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.rotation_matrix.Rot3Array.zz">
<span class="sig-name descname"><span class="pre">zz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.zz" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-deepfold.utils.geometry.utils">
<span id="deepfold-utils-geometry-utils-module"></span><h2>deepfold.utils.geometry.utils module<a class="headerlink" href="#module-deepfold.utils.geometry.utils" title="Link to this heading">¶</a></h2>
<p>Utils for geometry library.</p>
<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.geometry.utils.get_field_names">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.utils.</span></span><span class="sig-name descname"><span class="pre">get_field_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.utils.get_field_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-deepfold.utils.geometry.vector">
<span id="deepfold-utils-geometry-vector-module"></span><h2>deepfold.utils.geometry.vector module<a class="headerlink" href="#module-deepfold.utils.geometry.vector" title="Link to this heading">¶</a></h2>
<p>Vec3Array Class.</p>
<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.vector.</span></span><span class="sig-name descname"><span class="pre">Vec3Array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'torch.Tensor'</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'torch.Tensor'</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'torch.Tensor'</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.cat">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.cat" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.clone" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.cross">
<span class="sig-name descname"><span class="pre">cross</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.cross" title="Link to this definition">¶</a></dt>
<dd><p>Compute cross product between ‘self’ and ‘other’.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.dot">
<span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.dot" title="Link to this definition">¶</a></dt>
<dd><p>Compute dot product between ‘self’ and ‘other’.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.from_array">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.from_array" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.map_tensor_fn">
<span class="sig-name descname"><span class="pre">map_tensor_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.map_tensor_fn" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.norm" title="Link to this definition">¶</a></dt>
<dd><p>Compute Norm of Vec3Array, clipped to epsilon.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.norm2">
<span class="sig-name descname"><span class="pre">norm2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.norm2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.normalized">
<span class="sig-name descname"><span class="pre">normalized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.normalized" title="Link to this definition">¶</a></dt>
<dd><p>Return unit vector with optional clipping.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.reshape">
<span class="sig-name descname"><span class="pre">reshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_shape</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.reshape" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.shape" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.sum">
<span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.sum" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.to_tensor">
<span class="sig-name descname"><span class="pre">to_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.to_tensor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.unsqueeze">
<span class="sig-name descname"><span class="pre">unsqueeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.unsqueeze" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.x">
<span class="sig-name descname"><span class="pre">x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.x" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.y">
<span class="sig-name descname"><span class="pre">y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.y" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.z">
<span class="sig-name descname"><span class="pre">z</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.z" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.Vec3Array.zeros">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zeros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.vector.Vec3Array.zeros" title="Link to this definition">¶</a></dt>
<dd><p>Return Vec3Array corresponding to zeros of given shape.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.cross">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.vector.</span></span><span class="sig-name descname"><span class="pre">cross</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.cross" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.dihedral_angle">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.vector.</span></span><span class="sig-name descname"><span class="pre">dihedral_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.dihedral_angle" title="Link to this definition">¶</a></dt>
<dd><p>Computes torsion angle for a quadruple of points.</p>
<p>For points (a, b, c, d), this is the angle between the planes defined by
points (a, b, c) and (b, c, d). It is also known as the dihedral angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – A Vec3Array of coordinates.</p></li>
<li><p><strong>b</strong> – A Vec3Array of coordinates.</p></li>
<li><p><strong>c</strong> – A Vec3Array of coordinates.</p></li>
<li><p><strong>d</strong> – A Vec3Array of coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[-pi, pi].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tensor of angles in radians</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.dot">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.vector.</span></span><span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.dot" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.euclidean_distance">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.vector.</span></span><span class="sig-name descname"><span class="pre">euclidean_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.euclidean_distance" title="Link to this definition">¶</a></dt>
<dd><p>Computes euclidean distance between ‘vec1’ and ‘vec2’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vec1</strong> – Vec3Array to compute euclidean distance to</p></li>
<li><p><strong>vec2</strong> – Vec3Array to compute euclidean distance from, should be
broadcast compatible with ‘vec1’</p></li>
<li><p><strong>epsilon</strong> – distance is clipped from below to be at least epsilon</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of euclidean distances;
shape will be result of broadcasting ‘vec1’ and ‘vec2’</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.norm">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.vector.</span></span><span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.norm" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.normalized">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.vector.</span></span><span class="sig-name descname"><span class="pre">normalized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.normalized" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.geometry.vector.square_euclidean_distance">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.vector.</span></span><span class="sig-name descname"><span class="pre">square_euclidean_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.vector.square_euclidean_distance" title="Link to this definition">¶</a></dt>
<dd><p>Computes square of euclidean distance between ‘vec1’ and ‘vec2’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vec1</strong> – Vec3Array to compute    distance to</p></li>
<li><p><strong>vec2</strong> – Vec3Array to compute    distance from, should be
broadcast compatible with ‘vec1’</p></li>
<li><p><strong>epsilon</strong> – distance is clipped from below to be at least epsilon</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of square euclidean distances;
shape will be result of broadcasting ‘vec1’ and ‘vec2’</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-deepfold.utils.geometry">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-deepfold.utils.geometry" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.</span></span><span class="sig-name descname"><span class="pre">Rigid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Rigid" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class representing a rigid transformation. Little more than a wrapper
around two objects: a Rotation object and a [<a href="#id1"><span class="problematic" id="id2">*</span></a>, 3] translation
Designed to behave approximately like a single torch tensor with the
shape of the shared batch dimensions of its component parts.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.apply" title="Link to this definition">¶</a></dt>
<dd><p>Applies the transformation to a coordinate tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pts</strong> – A [<a href="#id3"><span class="problematic" id="id4">*</span></a>, 3] coordinate tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transformed points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.apply_rot_fn">
<span class="sig-name descname"><span class="pre">apply_rot_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.apply_rot_fn" title="Link to this definition">¶</a></dt>
<dd><p>Applies a Rotation -&gt; Rotation function to the stored rotation
object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn</strong> – A function of type Rotation -&gt; Rotation</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A transformation object with a transformed rotation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.apply_trans_fn">
<span class="sig-name descname"><span class="pre">apply_trans_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.apply_trans_fn" title="Link to this definition">¶</a></dt>
<dd><p>Applies a Tensor -&gt; Tensor function to the stored translation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn</strong> – A function of type Tensor -&gt; Tensor to be applied to the
translation</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A transformation object with a transformed translation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.cat">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.cat" title="Link to this definition">¶</a></dt>
<dd><p>Concatenates transformations along a new dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> – A list of T objects</p></li>
<li><p><strong>dim</strong> – The dimension along which the transformations should be
concatenated</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A concatenated transformation object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.compose">
<span class="sig-name descname"><span class="pre">compose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.compose" title="Link to this definition">¶</a></dt>
<dd><p>Composes the current rigid object with another.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> – Another Rigid object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The composition of the two transformations</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.compose_q_update_vec">
<span class="sig-name descname"><span class="pre">compose_q_update_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_update_vec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.compose_q_update_vec" title="Link to this definition">¶</a></dt>
<dd><p>Composes the transformation with a quaternion update vector of
shape [<a href="#id5"><span class="problematic" id="id6">*</span></a>, 6], where the final 6 columns represent the x, y, and
z values of a quaternion of form (1, x, y, z) followed by a 3D
translation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q_vec</strong> – The quaternion update vector.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The composed transformation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.cuda">
<span class="sig-name descname"><span class="pre">cuda</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.cuda" title="Link to this definition">¶</a></dt>
<dd><p>Moves the transformation object to GPU memory</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A version of the transformation on GPU</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rigid.device" title="Link to this definition">¶</a></dt>
<dd><p>Returns the device on which the Rigid’s tensors are located.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The device on which the Rigid’s tensors are located</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rigid.dtype" title="Link to this definition">¶</a></dt>
<dd><p>Returns the dtype of the Rigid tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dtype of the Rigid tensors</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.from_3_points">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_3_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_neg_x_axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_xy_plane</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.from_3_points" title="Link to this definition">¶</a></dt>
<dd><p>Implements algorithm 21. Constructs transformations from sets of 3 points using the Gram-Schmidt algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_neg_x_axis</strong> – [<a href="#id7"><span class="problematic" id="id8">*</span></a>, 3] coordinates</p></li>
<li><p><strong>origin</strong> – [<a href="#id9"><span class="problematic" id="id10">*</span></a>, 3] coordinates used as frame origins</p></li>
<li><p><strong>p_xy_plane</strong> – [<a href="#id11"><span class="problematic" id="id12">*</span></a>, 3] coordinates</p></li>
<li><p><strong>eps</strong> – Small epsilon value</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A transformation object of shape [*]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.from_tensor_4x4">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_tensor_4x4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.from_tensor_4x4" title="Link to this definition">¶</a></dt>
<dd><p>Constructs a transformation from a homogenous transformation
tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>t</strong> – [<a href="#id13"><span class="problematic" id="id14">*</span></a>, 4, 4] homogenous transformation tensor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>T object with shape [*]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.from_tensor_7">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_tensor_7</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_quats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.from_tensor_7" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.get_rots">
<span class="sig-name descname"><span class="pre">get_rots</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.get_rots" title="Link to this definition">¶</a></dt>
<dd><p>Getter for the rotation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The rotation object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.get_trans">
<span class="sig-name descname"><span class="pre">get_trans</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.get_trans" title="Link to this definition">¶</a></dt>
<dd><p>Getter for the translation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The stored translation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.identity">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'quat'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.identity" title="Link to this definition">¶</a></dt>
<dd><p>Constructs an identity transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> – The desired shape</p></li>
<li><p><strong>dtype</strong> – The dtype of both internal tensors</p></li>
<li><p><strong>device</strong> – The device of both internal tensors</p></li>
<li><p><strong>requires_grad</strong> – Whether grad should be enabled for the internal tensors</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The identity transformation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.invert">
<span class="sig-name descname"><span class="pre">invert</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.invert" title="Link to this definition">¶</a></dt>
<dd><p>Inverts the transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The inverse transformation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.invert_apply">
<span class="sig-name descname"><span class="pre">invert_apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.invert_apply" title="Link to this definition">¶</a></dt>
<dd><p>Applies the inverse of the transformation to a coordinate tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pts</strong> – A [<a href="#id15"><span class="problematic" id="id16">*</span></a>, 3] coordinate tensor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transformed points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.make_transform_from_reference">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">make_transform_from_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ca_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.make_transform_from_reference" title="Link to this definition">¶</a></dt>
<dd><p>Returns a transformation object from reference coordinates.</p>
<p>Note that this method does not take care of symmetries. If you
provide the atom positions in the non-standard way, the N atom will
end up not at [-0.527250, 1.359329, 0.0] but instead at
[-0.527250, -1.359329, 0.0]. You need to take care of such cases in
your code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_xyz</strong> – A [<a href="#id17"><span class="problematic" id="id18">*</span></a>, 3] tensor of nitrogen xyz coordinates.</p></li>
<li><p><strong>ca_xyz</strong> – A [<a href="#id19"><span class="problematic" id="id20">*</span></a>, 3] tensor of carbon alpha xyz coordinates.</p></li>
<li><p><strong>c_xyz</strong> – A [<a href="#id21"><span class="problematic" id="id22">*</span></a>, 3] tensor of carbon xyz coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A transformation object. After applying the translation and
rotation to the reference backbone, the coordinates will
approximately equal to the input coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.map_tensor_fn">
<span class="sig-name descname"><span class="pre">map_tensor_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.map_tensor_fn" title="Link to this definition">¶</a></dt>
<dd><p>Apply a Tensor -&gt; Tensor function to underlying translation and
rotation tensors, mapping over the translation/rotation dimensions
respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn</strong> – A Tensor -&gt; Tensor function to be mapped over the Rigid</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transformed Rigid object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.scale_translation">
<span class="sig-name descname"><span class="pre">scale_translation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trans_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.scale_translation" title="Link to this definition">¶</a></dt>
<dd><p>Scales the translation by a constant factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trans_scale_factor</strong> – The constant factor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A transformation object with a scaled translation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Size</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rigid.shape" title="Link to this definition">¶</a></dt>
<dd><p>Returns the shape of the shared dimensions of the rotation and
the translation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The shape of the transformation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.stop_rot_gradient">
<span class="sig-name descname"><span class="pre">stop_rot_gradient</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.stop_rot_gradient" title="Link to this definition">¶</a></dt>
<dd><p>Detaches the underlying rotation object</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A transformation object with detached rotations</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.to_tensor_4x4">
<span class="sig-name descname"><span class="pre">to_tensor_4x4</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.to_tensor_4x4" title="Link to this definition">¶</a></dt>
<dd><p>Converts a transformation to a homogenous transformation tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A [<a href="#id23"><span class="problematic" id="id24">*</span></a>, 4, 4] homogenous transformation tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.to_tensor_7">
<span class="sig-name descname"><span class="pre">to_tensor_7</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.to_tensor_7" title="Link to this definition">¶</a></dt>
<dd><p>Converts a transformation to a tensor with 7 final columns, four
for the quaternion followed by three for the translation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A [<a href="#id25"><span class="problematic" id="id26">*</span></a>, 7] tensor representation of the transformation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid.unsqueeze">
<span class="sig-name descname"><span class="pre">unsqueeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rigid" title="deepfold.utils.rigid_utils.Rigid"><span class="pre">Rigid</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid.unsqueeze" title="Link to this definition">¶</a></dt>
<dd><p>Analogous to torch.unsqueeze. The dimension is relative to the
shared dimensions of the rotation/translation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> – A positive or negative dimension index.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The unsqueezed transformation.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.</span></span><span class="sig-name descname"><span class="pre">Rigid3Array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rotation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">translation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Rigid Transformation, i.e. element of special euclidean group.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.apply" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.apply_inverse_to_point">
<span class="sig-name descname"><span class="pre">apply_inverse_to_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.apply_inverse_to_point" title="Link to this definition">¶</a></dt>
<dd><p>Apply inverse Rigid3Array transform to point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.apply_to_point">
<span class="sig-name descname"><span class="pre">apply_to_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.apply_to_point" title="Link to this definition">¶</a></dt>
<dd><p>Apply Rigid3Array transform to point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.cat">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rigids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.cat" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.compose">
<span class="sig-name descname"><span class="pre">compose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other_rigid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.compose" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.compose_rotation">
<span class="sig-name descname"><span class="pre">compose_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other_rotation</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.compose_rotation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.cuda">
<span class="sig-name descname"><span class="pre">cuda</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.cuda" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.device" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.dtype" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.from_array">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.from_array" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.from_array4x4">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_array4x4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.from_array4x4" title="Link to this definition">¶</a></dt>
<dd><p>Construct Rigid3Array from homogeneous 4x4 array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.from_tensor_4x4">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_tensor_4x4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.from_tensor_4x4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.identity">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.identity" title="Link to this definition">¶</a></dt>
<dd><p>Return identity Rigid3Array of given shape.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.inverse">
<span class="sig-name descname"><span class="pre">inverse</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.inverse" title="Link to this definition">¶</a></dt>
<dd><p>Return Rigid3Array corresponding to inverse transform.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.invert_apply">
<span class="sig-name descname"><span class="pre">invert_apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.invert_apply" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.map_tensor_fn">
<span class="sig-name descname"><span class="pre">map_tensor_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.map_tensor_fn" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.reshape">
<span class="sig-name descname"><span class="pre">reshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_shape</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.reshape" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.rotation">
<span class="sig-name descname"><span class="pre">rotation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></em><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.rotation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.scale_translation">
<span class="sig-name descname"><span class="pre">scale_translation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.scale_translation" title="Link to this definition">¶</a></dt>
<dd><p>Scale translation in Rigid3Array by ‘factor’.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Size</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.shape" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.stop_rot_gradient">
<span class="sig-name descname"><span class="pre">stop_rot_gradient</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array" title="deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><span class="pre">Rigid3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.stop_rot_gradient" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.to_tensor">
<span class="sig-name descname"><span class="pre">to_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.to_tensor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.to_tensor_4x4">
<span class="sig-name descname"><span class="pre">to_tensor_4x4</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.to_tensor_4x4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.translation">
<span class="sig-name descname"><span class="pre">translation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></em><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.translation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rigid3Array.unsqueeze">
<span class="sig-name descname"><span class="pre">unsqueeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Rigid3Array.unsqueeze" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.</span></span><span class="sig-name descname"><span class="pre">Rot3Array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Rot3Array Matrix in 3 dimensional Space implemented as struct of arrays.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.apply_inverse_to_point">
<span class="sig-name descname"><span class="pre">apply_inverse_to_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.apply_inverse_to_point" title="Link to this definition">¶</a></dt>
<dd><p>Applies inverse Rot3Array to point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.apply_to_point">
<span class="sig-name descname"><span class="pre">apply_to_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.apply_to_point" title="Link to this definition">¶</a></dt>
<dd><p>Applies Rot3Array to point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.cat">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.cat" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.from_array">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.from_array" title="Link to this definition">¶</a></dt>
<dd><p>Construct Rot3Array Matrix from array of shape. […, 3, 3].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.from_quaternion">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_quaternion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.from_quaternion" title="Link to this definition">¶</a></dt>
<dd><p>Construct Rot3Array from components of quaternion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.from_two_vectors">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_two_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">e1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.from_two_vectors" title="Link to this definition">¶</a></dt>
<dd><p>Construct Rot3Array from two Vectors.</p>
<p>Rot3Array is constructed such that in the corresponding frame ‘e0’ lies on
the positive x-Axis and ‘e1’ lies in the xy plane with positive sign of y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e0</strong> – Vector</p></li>
<li><p><strong>e1</strong> – Vector</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rot3Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.identity">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.identity" title="Link to this definition">¶</a></dt>
<dd><p>Returns identity of given shape.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.inverse">
<span class="sig-name descname"><span class="pre">inverse</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.inverse" title="Link to this definition">¶</a></dt>
<dd><p>Returns inverse of Rot3Array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.map_tensor_fn">
<span class="sig-name descname"><span class="pre">map_tensor_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.map_tensor_fn" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.reshape">
<span class="sig-name descname"><span class="pre">reshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.reshape" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.stop_gradient">
<span class="sig-name descname"><span class="pre">stop_gradient</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array" title="deepfold.utils.geometry.rotation_matrix.Rot3Array"><span class="pre">Rot3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.stop_gradient" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.to_tensor">
<span class="sig-name descname"><span class="pre">to_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.to_tensor" title="Link to this definition">¶</a></dt>
<dd><p>Convert Rot3Array to array of shape […, 3, 3].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.unsqueeze">
<span class="sig-name descname"><span class="pre">unsqueeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.unsqueeze" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.xx">
<span class="sig-name descname"><span class="pre">xx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.xx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.xy">
<span class="sig-name descname"><span class="pre">xy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.xy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.xz">
<span class="sig-name descname"><span class="pre">xz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.xz" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.yx">
<span class="sig-name descname"><span class="pre">yx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.yx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.yy">
<span class="sig-name descname"><span class="pre">yy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.yy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.yz">
<span class="sig-name descname"><span class="pre">yz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.yz" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.zx">
<span class="sig-name descname"><span class="pre">zx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.zx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.zy">
<span class="sig-name descname"><span class="pre">zy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.zy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rot3Array.zz">
<span class="sig-name descname"><span class="pre">zz</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rot3Array.zz" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.</span></span><span class="sig-name descname"><span class="pre">Rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rot_mats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_quats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Rotation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A 3D rotation. Depending on how the object is initialized, the
rotation is represented by either a rotation matrix or a
quaternion, though both formats are made available by helper functions.
To simplify gradient computation, the underlying format of the
rotation cannot be changed in-place. Like Rigid, the class is designed
to mimic the behavior of a torch Tensor, almost as if each Rotation
object were a tensor of rotations, in one format or another.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.apply" title="Link to this definition">¶</a></dt>
<dd><p>Apply the current Rotation as a rotation matrix to a set of 3D
coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pts</strong> – A [<a href="#id27"><span class="problematic" id="id28">*</span></a>, 3] set of points</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[<a href="#id29"><span class="problematic" id="id30">*</span></a>, 3] rotated points</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.cat">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.cat" title="Link to this definition">¶</a></dt>
<dd><p>Concatenates rotations along one of the batch dimensions. Analogous
to torch.cat().</p>
<p>Note that the output of this operation is always a rotation matrix,
regardless of the format of input rotations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rs</strong> – A list of rotation objects</p></li>
<li><p><strong>dim</strong> – The dimension along which the rotations should be
concatenated</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A concatenated Rotation object in rotation matrix format</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.compose_q">
<span class="sig-name descname"><span class="pre">compose_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_quats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.compose_q" title="Link to this definition">¶</a></dt>
<dd><p>Compose the quaternions of the current Rotation object with those
of another.</p>
<p>Depending on whether either Rotation was initialized with
quaternions, this function may call torch.linalg.eigh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> – An update rotation object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An updated rotation object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.compose_q_update_vec">
<span class="sig-name descname"><span class="pre">compose_q_update_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_update_vec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize_quats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.compose_q_update_vec" title="Link to this definition">¶</a></dt>
<dd><p>Returns a new quaternion Rotation after updating the current
object’s underlying rotation with a quaternion update, formatted
as a [<a href="#id31"><span class="problematic" id="id32">*</span></a>, 3] tensor whose final three columns represent x, y, z such
that (1, x, y, z) is the desired (not necessarily unit) quaternion
update.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_update_vec</strong> – A [<a href="#id33"><span class="problematic" id="id34">*</span></a>, 3] quaternion update tensor</p></li>
<li><p><strong>normalize_quats</strong> – Whether to normalize the output quaternion</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An updated Rotation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.compose_r">
<span class="sig-name descname"><span class="pre">compose_r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.compose_r" title="Link to this definition">¶</a></dt>
<dd><p>Compose the rotation matrices of the current Rotation object with
those of another.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> – An update rotation object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An updated rotation object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.cuda">
<span class="sig-name descname"><span class="pre">cuda</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.cuda" title="Link to this definition">¶</a></dt>
<dd><p>Analogous to the cuda() method of torch Tensors</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A copy of the Rotation in CUDA memory</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.detach">
<span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.detach" title="Link to this definition">¶</a></dt>
<dd><p>Returns a copy of the Rotation whose underlying Tensor has been
detached from its torch graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A copy of the Rotation whose underlying Tensor has been detached
from its torch graph</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rotation.device" title="Link to this definition">¶</a></dt>
<dd><p>The device of the underlying rotation</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The device of the underlying rotation</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rotation.dtype" title="Link to this definition">¶</a></dt>
<dd><p>Returns the dtype of the underlying rotation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dtype of the underlying rotation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.get_cur_rot">
<span class="sig-name descname"><span class="pre">get_cur_rot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.get_cur_rot" title="Link to this definition">¶</a></dt>
<dd><p>Return the underlying rotation in its current form</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The stored rotation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.get_quats">
<span class="sig-name descname"><span class="pre">get_quats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.get_quats" title="Link to this definition">¶</a></dt>
<dd><p>Returns the underlying rotation as a quaternion tensor.</p>
<p>Depending on whether the Rotation was initialized with a
quaternion, this function may call torch.linalg.eigh.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The rotation as a quaternion tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.get_rot_mats">
<span class="sig-name descname"><span class="pre">get_rot_mats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.get_rot_mats" title="Link to this definition">¶</a></dt>
<dd><p>Returns the underlying rotation as a rotation matrix tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The rotation as a rotation matrix tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.identity">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'quat'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.identity" title="Link to this definition">¶</a></dt>
<dd><p>Returns an identity Rotation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> – The “shape” of the resulting Rotation object. See documentation
for the shape property</p></li>
<li><p><strong>dtype</strong> – The torch dtype for the rotation</p></li>
<li><p><strong>device</strong> – The torch device for the new rotation</p></li>
<li><p><strong>requires_grad</strong> – Whether the underlying tensors in the new rotation object
should require gradient computation</p></li>
<li><p><strong>fmt</strong> – One of “quat” or “rot_mat”. Determines the underlying format
of the new object’s rotation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new identity rotation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.invert">
<span class="sig-name descname"><span class="pre">invert</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.invert" title="Link to this definition">¶</a></dt>
<dd><p>Returns the inverse of the current Rotation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The inverse of the current Rotation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.invert_apply">
<span class="sig-name descname"><span class="pre">invert_apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.invert_apply" title="Link to this definition">¶</a></dt>
<dd><p>The inverse of the apply() method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pts</strong> – A [<a href="#id35"><span class="problematic" id="id36">*</span></a>, 3] set of points</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[<a href="#id37"><span class="problematic" id="id38">*</span></a>, 3] inverse-rotated points</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.map_tensor_fn">
<span class="sig-name descname"><span class="pre">map_tensor_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.map_tensor_fn" title="Link to this definition">¶</a></dt>
<dd><p>Apply a Tensor -&gt; Tensor function to underlying rotation tensors,
mapping over the rotation dimension(s). Can be used e.g. to sum out
a one-hot batch dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn</strong> – A Tensor -&gt; Tensor function to be mapped over the Rotation</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transformed Rotation object</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.requires_grad">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">requires_grad</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rotation.requires_grad" title="Link to this definition">¶</a></dt>
<dd><p>Returns the requires_grad property of the underlying rotation</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The requires_grad property of the underlying tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Size</span></em><a class="headerlink" href="#deepfold.utils.geometry.Rotation.shape" title="Link to this definition">¶</a></dt>
<dd><p>Returns the virtual shape of the rotation object. This shape is
defined as the batch dimensions of the underlying rotation matrix
or quaternion. If the Rotation was initialized with a [10, 3, 3]
rotation matrix tensor, for example, the resulting shape would be
[10].</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The virtual shape of the rotation object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.to" title="Link to this definition">¶</a></dt>
<dd><p>Analogous to the to() method of torch Tensors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> – A torch device</p></li>
<li><p><strong>dtype</strong> – A torch dtype</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A copy of the Rotation using the new device and dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Rotation.unsqueeze">
<span class="sig-name descname"><span class="pre">unsqueeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deepfold.utils.html#deepfold.utils.rigid_utils.Rotation" title="deepfold.utils.rigid_utils.Rotation"><span class="pre">Rotation</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Rotation.unsqueeze" title="Link to this definition">¶</a></dt>
<dd><p>Analogous to torch.unsqueeze. The dimension is relative to the
shape of the Rotation object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> – A positive or negative dimension index.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The unsqueezed Rotation.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.</span></span><span class="sig-name descname"><span class="pre">Vec3Array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'torch.Tensor'</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'torch.Tensor'</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="s"><span class="pre">'torch.Tensor'</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.cat">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.cat" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.clone" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.cross">
<span class="sig-name descname"><span class="pre">cross</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.cross" title="Link to this definition">¶</a></dt>
<dd><p>Compute cross product between ‘self’ and ‘other’.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.dot">
<span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.dot" title="Link to this definition">¶</a></dt>
<dd><p>Compute dot product between ‘self’ and ‘other’.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.from_array">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.from_array" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.map_tensor_fn">
<span class="sig-name descname"><span class="pre">map_tensor_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.map_tensor_fn" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.norm" title="Link to this definition">¶</a></dt>
<dd><p>Compute Norm of Vec3Array, clipped to epsilon.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.norm2">
<span class="sig-name descname"><span class="pre">norm2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.norm2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.normalized">
<span class="sig-name descname"><span class="pre">normalized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.normalized" title="Link to this definition">¶</a></dt>
<dd><p>Return unit vector with optional clipping.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.reshape">
<span class="sig-name descname"><span class="pre">reshape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_shape</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.reshape" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.shape" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.sum">
<span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.sum" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.to_tensor">
<span class="sig-name descname"><span class="pre">to_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.to_tensor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.unsqueeze">
<span class="sig-name descname"><span class="pre">unsqueeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.unsqueeze" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.x">
<span class="sig-name descname"><span class="pre">x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.x" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.y">
<span class="sig-name descname"><span class="pre">y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.y" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.z">
<span class="sig-name descname"><span class="pre">z</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.z" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepfold.utils.geometry.Vec3Array.zeros">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zeros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepfold.utils.geometry.Vec3Array.zeros" title="Link to this definition">¶</a></dt>
<dd><p>Return Vec3Array corresponding to zeros of given shape.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.geometry.dihedral_angle">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.</span></span><span class="sig-name descname"><span class="pre">dihedral_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.dihedral_angle" title="Link to this definition">¶</a></dt>
<dd><p>Computes torsion angle for a quadruple of points.</p>
<p>For points (a, b, c, d), this is the angle between the planes defined by
points (a, b, c) and (b, c, d). It is also known as the dihedral angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – A Vec3Array of coordinates.</p></li>
<li><p><strong>b</strong> – A Vec3Array of coordinates.</p></li>
<li><p><strong>c</strong> – A Vec3Array of coordinates.</p></li>
<li><p><strong>d</strong> – A Vec3Array of coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[-pi, pi].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tensor of angles in radians</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.geometry.euclidean_distance">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.</span></span><span class="sig-name descname"><span class="pre">euclidean_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.euclidean_distance" title="Link to this definition">¶</a></dt>
<dd><p>Computes euclidean distance between ‘vec1’ and ‘vec2’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vec1</strong> – Vec3Array to compute euclidean distance to</p></li>
<li><p><strong>vec2</strong> – Vec3Array to compute euclidean distance from, should be
broadcast compatible with ‘vec1’</p></li>
<li><p><strong>epsilon</strong> – distance is clipped from below to be at least epsilon</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of euclidean distances;
shape will be result of broadcasting ‘vec1’ and ‘vec2’</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepfold.utils.geometry.square_euclidean_distance">
<span class="sig-prename descclassname"><span class="pre">deepfold.utils.geometry.</span></span><span class="sig-name descname"><span class="pre">square_euclidean_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array" title="deepfold.utils.geometry.vector.Vec3Array"><span class="pre">Vec3Array</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></span><a class="headerlink" href="#deepfold.utils.geometry.square_euclidean_distance" title="Link to this definition">¶</a></dt>
<dd><p>Computes square of euclidean distance between ‘vec1’ and ‘vec2’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vec1</strong> – Vec3Array to compute    distance to</p></li>
<li><p><strong>vec2</strong> – Vec3Array to compute    distance from, should be
broadcast compatible with ‘vec1’</p></li>
<li><p><strong>epsilon</strong> – distance is clipped from below to be at least epsilon</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of square euclidean distances;
shape will be result of broadcasting ‘vec1’ and ‘vec2’</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Paek et al.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">deepfold.utils.geometry package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-deepfold.utils.geometry.quat_rigid">deepfold.utils.geometry.quat_rigid module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.quat_rigid.QuatRigid"><code class="docutils literal notranslate"><span class="pre">QuatRigid</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.quat_rigid.QuatRigid.forward"><code class="docutils literal notranslate"><span class="pre">QuatRigid.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.geometry.rigid_matrix_vector">deepfold.utils.geometry.rigid_matrix_vector module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array"><code class="docutils literal notranslate"><span class="pre">Rigid3Array</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.apply"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.apply()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.apply_inverse_to_point"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.apply_inverse_to_point()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.apply_to_point"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.apply_to_point()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.cat"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.cat()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.compose"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.compose()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.compose_rotation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.compose_rotation()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.cuda"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.cuda()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.device"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.device</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.dtype"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.dtype</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.from_array"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.from_array()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.from_array4x4"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.from_array4x4()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.from_tensor_4x4"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.from_tensor_4x4()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.identity"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.identity()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.inverse"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.inverse()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.invert_apply"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.invert_apply()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.map_tensor_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.reshape"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.reshape()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.rotation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.rotation</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.scale_translation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.scale_translation()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.shape"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.shape</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.stop_rot_gradient"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.stop_rot_gradient()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.to_tensor"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.to_tensor()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.to_tensor_4x4"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.to_tensor_4x4()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.translation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.translation</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rigid_matrix_vector.Rigid3Array.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.unsqueeze()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.geometry.rotation_matrix">deepfold.utils.geometry.rotation_matrix module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array"><code class="docutils literal notranslate"><span class="pre">Rot3Array</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.apply_inverse_to_point"><code class="docutils literal notranslate"><span class="pre">Rot3Array.apply_inverse_to_point()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.apply_to_point"><code class="docutils literal notranslate"><span class="pre">Rot3Array.apply_to_point()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.cat"><code class="docutils literal notranslate"><span class="pre">Rot3Array.cat()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.from_array"><code class="docutils literal notranslate"><span class="pre">Rot3Array.from_array()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.from_quaternion"><code class="docutils literal notranslate"><span class="pre">Rot3Array.from_quaternion()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.from_two_vectors"><code class="docutils literal notranslate"><span class="pre">Rot3Array.from_two_vectors()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.identity"><code class="docutils literal notranslate"><span class="pre">Rot3Array.identity()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.inverse"><code class="docutils literal notranslate"><span class="pre">Rot3Array.inverse()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Rot3Array.map_tensor_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.reshape"><code class="docutils literal notranslate"><span class="pre">Rot3Array.reshape()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.stop_gradient"><code class="docutils literal notranslate"><span class="pre">Rot3Array.stop_gradient()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.to_tensor"><code class="docutils literal notranslate"><span class="pre">Rot3Array.to_tensor()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Rot3Array.unsqueeze()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.xx"><code class="docutils literal notranslate"><span class="pre">Rot3Array.xx</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.xy"><code class="docutils literal notranslate"><span class="pre">Rot3Array.xy</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.xz"><code class="docutils literal notranslate"><span class="pre">Rot3Array.xz</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.yx"><code class="docutils literal notranslate"><span class="pre">Rot3Array.yx</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.yy"><code class="docutils literal notranslate"><span class="pre">Rot3Array.yy</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.yz"><code class="docutils literal notranslate"><span class="pre">Rot3Array.yz</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.zx"><code class="docutils literal notranslate"><span class="pre">Rot3Array.zx</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.zy"><code class="docutils literal notranslate"><span class="pre">Rot3Array.zy</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.rotation_matrix.Rot3Array.zz"><code class="docutils literal notranslate"><span class="pre">Rot3Array.zz</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.geometry.utils">deepfold.utils.geometry.utils module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.utils.get_field_names"><code class="docutils literal notranslate"><span class="pre">get_field_names()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.geometry.vector">deepfold.utils.geometry.vector module</a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array"><code class="docutils literal notranslate"><span class="pre">Vec3Array</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.cat"><code class="docutils literal notranslate"><span class="pre">Vec3Array.cat()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.clone"><code class="docutils literal notranslate"><span class="pre">Vec3Array.clone()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.cross"><code class="docutils literal notranslate"><span class="pre">Vec3Array.cross()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.dot"><code class="docutils literal notranslate"><span class="pre">Vec3Array.dot()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.from_array"><code class="docutils literal notranslate"><span class="pre">Vec3Array.from_array()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Vec3Array.map_tensor_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.norm"><code class="docutils literal notranslate"><span class="pre">Vec3Array.norm()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.norm2"><code class="docutils literal notranslate"><span class="pre">Vec3Array.norm2()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.normalized"><code class="docutils literal notranslate"><span class="pre">Vec3Array.normalized()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.reshape"><code class="docutils literal notranslate"><span class="pre">Vec3Array.reshape()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.shape"><code class="docutils literal notranslate"><span class="pre">Vec3Array.shape</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.sum"><code class="docutils literal notranslate"><span class="pre">Vec3Array.sum()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.to_tensor"><code class="docutils literal notranslate"><span class="pre">Vec3Array.to_tensor()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Vec3Array.unsqueeze()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.x"><code class="docutils literal notranslate"><span class="pre">Vec3Array.x</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.y"><code class="docutils literal notranslate"><span class="pre">Vec3Array.y</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.z"><code class="docutils literal notranslate"><span class="pre">Vec3Array.z</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.Vec3Array.zeros"><code class="docutils literal notranslate"><span class="pre">Vec3Array.zeros()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.cross"><code class="docutils literal notranslate"><span class="pre">cross()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.dihedral_angle"><code class="docutils literal notranslate"><span class="pre">dihedral_angle()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.dot"><code class="docutils literal notranslate"><span class="pre">dot()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.euclidean_distance"><code class="docutils literal notranslate"><span class="pre">euclidean_distance()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.norm"><code class="docutils literal notranslate"><span class="pre">norm()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.normalized"><code class="docutils literal notranslate"><span class="pre">normalized()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.vector.square_euclidean_distance"><code class="docutils literal notranslate"><span class="pre">square_euclidean_distance()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepfold.utils.geometry">Module contents</a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid"><code class="docutils literal notranslate"><span class="pre">Rigid</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.apply"><code class="docutils literal notranslate"><span class="pre">Rigid.apply()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.apply_rot_fn"><code class="docutils literal notranslate"><span class="pre">Rigid.apply_rot_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.apply_trans_fn"><code class="docutils literal notranslate"><span class="pre">Rigid.apply_trans_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.cat"><code class="docutils literal notranslate"><span class="pre">Rigid.cat()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.compose"><code class="docutils literal notranslate"><span class="pre">Rigid.compose()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.compose_q_update_vec"><code class="docutils literal notranslate"><span class="pre">Rigid.compose_q_update_vec()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.cuda"><code class="docutils literal notranslate"><span class="pre">Rigid.cuda()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.device"><code class="docutils literal notranslate"><span class="pre">Rigid.device</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.dtype"><code class="docutils literal notranslate"><span class="pre">Rigid.dtype</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.from_3_points"><code class="docutils literal notranslate"><span class="pre">Rigid.from_3_points()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.from_tensor_4x4"><code class="docutils literal notranslate"><span class="pre">Rigid.from_tensor_4x4()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.from_tensor_7"><code class="docutils literal notranslate"><span class="pre">Rigid.from_tensor_7()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.get_rots"><code class="docutils literal notranslate"><span class="pre">Rigid.get_rots()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.get_trans"><code class="docutils literal notranslate"><span class="pre">Rigid.get_trans()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.identity"><code class="docutils literal notranslate"><span class="pre">Rigid.identity()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.invert"><code class="docutils literal notranslate"><span class="pre">Rigid.invert()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.invert_apply"><code class="docutils literal notranslate"><span class="pre">Rigid.invert_apply()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.make_transform_from_reference"><code class="docutils literal notranslate"><span class="pre">Rigid.make_transform_from_reference()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Rigid.map_tensor_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.scale_translation"><code class="docutils literal notranslate"><span class="pre">Rigid.scale_translation()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.shape"><code class="docutils literal notranslate"><span class="pre">Rigid.shape</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.stop_rot_gradient"><code class="docutils literal notranslate"><span class="pre">Rigid.stop_rot_gradient()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.to_tensor_4x4"><code class="docutils literal notranslate"><span class="pre">Rigid.to_tensor_4x4()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.to_tensor_7"><code class="docutils literal notranslate"><span class="pre">Rigid.to_tensor_7()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Rigid.unsqueeze()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array"><code class="docutils literal notranslate"><span class="pre">Rigid3Array</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.apply"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.apply()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.apply_inverse_to_point"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.apply_inverse_to_point()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.apply_to_point"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.apply_to_point()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.cat"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.cat()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.compose"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.compose()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.compose_rotation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.compose_rotation()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.cuda"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.cuda()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.device"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.device</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.dtype"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.dtype</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.from_array"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.from_array()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.from_array4x4"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.from_array4x4()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.from_tensor_4x4"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.from_tensor_4x4()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.identity"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.identity()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.inverse"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.inverse()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.invert_apply"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.invert_apply()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.map_tensor_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.reshape"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.reshape()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.rotation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.rotation</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.scale_translation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.scale_translation()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.shape"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.shape</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.stop_rot_gradient"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.stop_rot_gradient()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.to_tensor"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.to_tensor()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.to_tensor_4x4"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.to_tensor_4x4()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.translation"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.translation</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rigid3Array.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Rigid3Array.unsqueeze()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array"><code class="docutils literal notranslate"><span class="pre">Rot3Array</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.apply_inverse_to_point"><code class="docutils literal notranslate"><span class="pre">Rot3Array.apply_inverse_to_point()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.apply_to_point"><code class="docutils literal notranslate"><span class="pre">Rot3Array.apply_to_point()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.cat"><code class="docutils literal notranslate"><span class="pre">Rot3Array.cat()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.from_array"><code class="docutils literal notranslate"><span class="pre">Rot3Array.from_array()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.from_quaternion"><code class="docutils literal notranslate"><span class="pre">Rot3Array.from_quaternion()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.from_two_vectors"><code class="docutils literal notranslate"><span class="pre">Rot3Array.from_two_vectors()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.identity"><code class="docutils literal notranslate"><span class="pre">Rot3Array.identity()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.inverse"><code class="docutils literal notranslate"><span class="pre">Rot3Array.inverse()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Rot3Array.map_tensor_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.reshape"><code class="docutils literal notranslate"><span class="pre">Rot3Array.reshape()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.stop_gradient"><code class="docutils literal notranslate"><span class="pre">Rot3Array.stop_gradient()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.to_tensor"><code class="docutils literal notranslate"><span class="pre">Rot3Array.to_tensor()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Rot3Array.unsqueeze()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.xx"><code class="docutils literal notranslate"><span class="pre">Rot3Array.xx</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.xy"><code class="docutils literal notranslate"><span class="pre">Rot3Array.xy</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.xz"><code class="docutils literal notranslate"><span class="pre">Rot3Array.xz</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.yx"><code class="docutils literal notranslate"><span class="pre">Rot3Array.yx</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.yy"><code class="docutils literal notranslate"><span class="pre">Rot3Array.yy</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.yz"><code class="docutils literal notranslate"><span class="pre">Rot3Array.yz</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.zx"><code class="docutils literal notranslate"><span class="pre">Rot3Array.zx</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.zy"><code class="docutils literal notranslate"><span class="pre">Rot3Array.zy</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rot3Array.zz"><code class="docutils literal notranslate"><span class="pre">Rot3Array.zz</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation"><code class="docutils literal notranslate"><span class="pre">Rotation</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.apply"><code class="docutils literal notranslate"><span class="pre">Rotation.apply()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.cat"><code class="docutils literal notranslate"><span class="pre">Rotation.cat()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.compose_q"><code class="docutils literal notranslate"><span class="pre">Rotation.compose_q()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.compose_q_update_vec"><code class="docutils literal notranslate"><span class="pre">Rotation.compose_q_update_vec()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.compose_r"><code class="docutils literal notranslate"><span class="pre">Rotation.compose_r()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.cuda"><code class="docutils literal notranslate"><span class="pre">Rotation.cuda()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.detach"><code class="docutils literal notranslate"><span class="pre">Rotation.detach()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.device"><code class="docutils literal notranslate"><span class="pre">Rotation.device</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.dtype"><code class="docutils literal notranslate"><span class="pre">Rotation.dtype</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.get_cur_rot"><code class="docutils literal notranslate"><span class="pre">Rotation.get_cur_rot()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.get_quats"><code class="docutils literal notranslate"><span class="pre">Rotation.get_quats()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.get_rot_mats"><code class="docutils literal notranslate"><span class="pre">Rotation.get_rot_mats()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.identity"><code class="docutils literal notranslate"><span class="pre">Rotation.identity()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.invert"><code class="docutils literal notranslate"><span class="pre">Rotation.invert()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.invert_apply"><code class="docutils literal notranslate"><span class="pre">Rotation.invert_apply()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Rotation.map_tensor_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.requires_grad"><code class="docutils literal notranslate"><span class="pre">Rotation.requires_grad</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.shape"><code class="docutils literal notranslate"><span class="pre">Rotation.shape</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.to"><code class="docutils literal notranslate"><span class="pre">Rotation.to()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Rotation.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Rotation.unsqueeze()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array"><code class="docutils literal notranslate"><span class="pre">Vec3Array</span></code></a><ul>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.cat"><code class="docutils literal notranslate"><span class="pre">Vec3Array.cat()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.clone"><code class="docutils literal notranslate"><span class="pre">Vec3Array.clone()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.cross"><code class="docutils literal notranslate"><span class="pre">Vec3Array.cross()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.dot"><code class="docutils literal notranslate"><span class="pre">Vec3Array.dot()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.from_array"><code class="docutils literal notranslate"><span class="pre">Vec3Array.from_array()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.map_tensor_fn"><code class="docutils literal notranslate"><span class="pre">Vec3Array.map_tensor_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.norm"><code class="docutils literal notranslate"><span class="pre">Vec3Array.norm()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.norm2"><code class="docutils literal notranslate"><span class="pre">Vec3Array.norm2()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.normalized"><code class="docutils literal notranslate"><span class="pre">Vec3Array.normalized()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.reshape"><code class="docutils literal notranslate"><span class="pre">Vec3Array.reshape()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.shape"><code class="docutils literal notranslate"><span class="pre">Vec3Array.shape</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.sum"><code class="docutils literal notranslate"><span class="pre">Vec3Array.sum()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.to_tensor"><code class="docutils literal notranslate"><span class="pre">Vec3Array.to_tensor()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.unsqueeze"><code class="docutils literal notranslate"><span class="pre">Vec3Array.unsqueeze()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.x"><code class="docutils literal notranslate"><span class="pre">Vec3Array.x</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.y"><code class="docutils literal notranslate"><span class="pre">Vec3Array.y</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.z"><code class="docutils literal notranslate"><span class="pre">Vec3Array.z</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.Vec3Array.zeros"><code class="docutils literal notranslate"><span class="pre">Vec3Array.zeros()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepfold.utils.geometry.dihedral_angle"><code class="docutils literal notranslate"><span class="pre">dihedral_angle()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.euclidean_distance"><code class="docutils literal notranslate"><span class="pre">euclidean_distance()</span></code></a></li>
<li><a class="reference internal" href="#deepfold.utils.geometry.square_euclidean_distance"><code class="docutils literal notranslate"><span class="pre">square_euclidean_distance()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>